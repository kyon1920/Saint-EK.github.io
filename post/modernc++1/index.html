<!DOCTYPE html>
<html lang="zh-cn" >
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>

  
  <meta name="author"
        content="Bruce Cheung"/>

  
  <meta name="description" content=""/>
  

  
  
  <meta name="keywords" content="blog, simple, dream"/>
  

  
  <link rel="canonical" href="https://oubc.github.io/post/modernc&#43;&#43;1/"/>

  

  <title>Modern C&#43;&#43; å¤šçº¿ç¨‹ thread &middot; Love, or death</title>

  <link rel="shortcut icon" href="https://oubc.github.io/images/favicon.ico"/>
  <link rel="stylesheet" href="https://oubc.github.io/css/animate.min.css"/>
  <link rel="stylesheet" href="https://oubc.github.io/css/remixicon.css"/>
  <link rel="stylesheet" href="https://oubc.github.io/css/zozo.css"/>
  <link rel="stylesheet" href="https://oubc.github.io/css/highlight.css"/>

  
  
</head>

<body>
<div class="main animated">
  <div class="nav_container animated fadeInDown">
  <div class="site_nav" id="site_nav">
    <ul>
      
      <li>
        <a href="/">é¦–é¡µ</a>
      </li>
      
      <li>
        <a href="/post/">å½’æ¡£</a>
      </li>
      
      <li>
        <a href="/tags/">æ ‡ç­¾</a>
      </li>
      
      <li>
        <a href="/about/">å…³äº</a>
      </li>
      
    </ul>
  </div>
  <div class="menu_icon">
    <a id="menu_icon"><i class="remixicon-links-line"></i></a>
  </div>
</div>

  <div class="header animated fadeInDown">
  <div class="site_title_container">
    <div class="site_title">
      <h1>
        <a href="https://oubc.github.io/">
          <span>Love, or death</span>
          <img src="https://oubc.github.io/images/logo.svg"/>
        </a>
      </h1>
    </div>
    <div class="description">
      <p class="sub_title">For you, a thousand times over.</p>
      <div class="my_socials">
        
        
        <a href="https://github.com/oubc" title="github" target="_blank"><i class="remixicon-github-fill"></i></a>
        
        
        
        <a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=uYGOjo6OiIuLivnIyJfa1tQ" title="mail" target="_blank"><i class="remixicon-mail-fill"></i></a>
        
        
        
        <a href="http://sighttp.qq.com/msgrd?v=1&amp;uin=877771223" title="qq" target="_blank"><i class="remixicon-qq-fill"></i></a>
        
        
        
        <a href="https://github.com/oubc/oubc.github.io/blob/master/images/wx.jpg?raw=true" title="wechat" target="_blank"><i class="remixicon-wechat-fill"></i></a>
        
        
        
        <a href="https://weibo.com/u/6993631995?topnav=1&amp;wvr=6&amp;topsug=1" title="weibo" target="_blank"><i class="remixicon-weibo-fill"></i></a>
        
        
        <a href="https://oubc.github.io/index.xml" type="application/rss+xml" title="rss" target="_blank"><i class="remixicon-rss-fill"></i></a>
      </div>
    </div>
  </div>
</div>

  <div class="content">
    <div class="post_page">
      <div class="post animated fadeInDown">
        <div class="post_title post_detail_title">
          <h2><a href='/post/modernc&#43;&#43;1/'>Modern C&#43;&#43; å¤šçº¿ç¨‹ thread</a></h2>
          <span class="date">2020.02.11</span>
        </div>
        <div class="post_content markdown"><p><br>
<br><font color=green size = 5>C++å¤šçº¿ç¨‹ æ€»è¿°</font>
<br>
<br>C++ä¸­å…³äºå¹¶å‘å¤šçº¿ç¨‹éƒ¨åˆ†ä¸»è¦åŒ…å«äº† &lt;thread&gt; &lt;mutex&gt; &lt;atomic&gt; &lt;condition_varible&gt; &lt;future&gt; äº”ä¸ªéƒ¨åˆ†
<br> â— &lt;thread&gt;ï¼šè¯¥å¤´æ–‡ä»¶ä¸»è¦å£°æ˜äº† std::thread ç±»ï¼Œå¦å¤– std::this_thread å‘½åç©ºé—´ä¹Ÿåœ¨è¯¥å¤´æ–‡ä»¶ä¸­ã€‚
<br> â— &lt;mutex&gt;ï¼šè¯¥å¤´æ–‡ä»¶ä¸»è¦å£°æ˜äº†ä¸äº’æ–¥é‡(mutex)ç›¸å…³çš„ç±»ï¼ŒåŒ…æ‹¬ std::mutex ç³»åˆ—ç±»ï¼Œstd::lock_guard, std::unique_lock, ä»¥åŠå…¶ä»–çš„ç±»å‹å’Œå‡½æ•°ã€‚
<br> â— &lt;atomic&gt;ï¼šè¯¥å¤´æ–‡ä¸»è¦å£°æ˜äº†ä¸¤ä¸ªç±», std::atomic å’Œ std::atomic_flagï¼Œå¦å¤–è¿˜å£°æ˜äº†ä¸€å¥— C é£æ ¼çš„åŸå­ç±»å‹å’Œä¸ C å…¼å®¹çš„åŸå­æ“ä½œçš„å‡½æ•°ã€‚
<br> â— &lt;condition_varible&gt;ï¼šè¯¥å¤´æ–‡ä»¶ä¸»è¦å£°æ˜äº†ä¸æ¡ä»¶å˜é‡ç›¸å…³çš„ç±»ï¼ŒåŒ…æ‹¬ std::condition_variable å’Œ std::condition_variable_anyã€‚
<br> â— &lt;future&gt;ï¼šè¯¥å¤´æ–‡ä»¶ä¸»è¦å£°æ˜äº† std::promise, std::package_task ä¸¤ä¸ª Provider ç±»ï¼Œä»¥åŠ std::future å’Œ std::shared_future ä¸¤ä¸ª Future ç±»ï¼Œå¦å¤–è¿˜æœ‰ä¸€äº›ä¸ä¹‹ç›¸å…³çš„ç±»å‹å’Œå‡½æ•°ï¼Œstd::async() å‡½æ•°å°±å£°æ˜åœ¨æ­¤å¤´æ–‡ä»¶ä¸­ã€‚
<br>
<br><font color=green size = 5>C++æ–°æ ‡å‡†ä¹‹å¤šçº¿ç¨‹ thread</font>
<br>
<br>C++æ–°æ ‡å‡†æä¾›äº†ä¸€å¥—ç²¾ç»ƒçš„çº¿ç¨‹åº“ï¼Œå°å·§ä¸”æ˜“ç”¨ã€‚è¿è¡Œä¸€ä¸ªçº¿ç¨‹ï¼Œå¯ä»¥ç›´æ¥åˆ›å»ºä¸€ä¸ªstd::threadçš„å®ä¾‹ï¼Œçº¿ç¨‹åœ¨å®ä¾‹æˆåŠŸæ„é€ æˆæ—¶å¯åŠ¨ã€‚è‹¥æœ‰åº•å±‚å¹³å°æ”¯æŒï¼Œæˆå‘˜å‡½æ•°std::thread::native_handle()å°†å¯æä¾›å¯¹åŸç”Ÿçº¿ç¨‹å¯¹è±¡è¿è¡Œå¹³å°ç‰¹å®šçš„æ“ä½œã€‚
<br>
<br><font color=green size = 4>thread æˆå‘˜å˜é‡</font>
<br> ğŸ¯ idï¼šThread ID (public member type)
<br> ğŸ¯ native_handle_typeï¼šNative handle type (public member type)
<br> â— thread::idæ˜¯çº¿ç¨‹è°ƒç”¨get_idå’Œthis_thread::get_idçš„è¿”å›å€¼ï¼›thread::idé»˜è®¤æ„é€ å‡½æ•°çš„ç»“æœæ˜¯ä¸€ä¸ªnon-joinableçš„å€¼ï¼›é€šå¸¸ç”¨æ¥å’Œå…¶ä»–çº¿ç¨‹ thread::get_idçš„ç»“æœåšæ¯”è¾ƒã€‚
<br> â— thread::native_handle_typeæœ¬åœ°å¥æŸ„ç±»å‹ï¼Œå¦‚æœåº“å®ç°æ”¯æŒå®ƒï¼Œè¿™ä¸ªæˆå‘˜ç±»å‹åªå­˜åœ¨äºç±»çº¿ç¨‹ä¸­ã€‚æ˜¯threadç±»æˆå‘˜å‡½æ•°thread::native_handleçš„è¿”å›å€¼ã€‚
<br>å®šä¹‰: typedef /* implementation-defined */ native_handle_type;
<br>
<br><font color=green size = 4>thread æˆå‘˜å‡½æ•°</font>
<table border = "4">
<tr>
<th>å‡½æ•°</th>
<th>è§£é‡Š</th>
</tr>
<tr>
<td>(constructor)</td>
<td>Construct thread (public member function )</td>
</tr>
<tr>
<td>(destructor)</td>
<td>Thread destructor (public member function )</td>
</tr>
<tr>
<td>operator=</td>
<td>Move-assign thread (public member function )</td>
</tr>
<tr>
<td>get_id</td>
<td>Get thread ID (public member function )</td>
</tr>
<tr>
<td>join</td>
<td>Join thread (public member function )</td>
</tr>
<tr>
<td>joinable</td>
<td>Check if joinable (public member function )</td>
</tr>
<tr>
<td>detach</td>
<td>Detach thread (public member function )</td>
</tr><tr>
<td>swap</td>
<td>Swap threads (public member function )</td>
</tr>
<tr>
<td>native_handle</td>
<td>Get native handle (public member function )</td>
</tr>
<tr>
<td>hardware_concurrency</td>
<td>Detect hardware concurrency (public static member function )</td>
</tr>
</table>
<br>
<br><font color=green size = 4>thread ä½¿ç”¨åŠè¯´æ˜</font>
<br> ğŸ¯ æ„é€ å‡½æ•°(constructor)
<br> default (1) thread() noexcept;
<br> initialization(2) template &lt;class Fn, class... Args&gt;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;explicit thread (Fn&amp;&amp; fn, Args&amp;&amp;... args);
<br>copy [deleted] (3) thread (const thread&amp;) = delete;
<br>move (4) thread (thread&amp;&amp; x) noexcept;
<br>(1) é»˜è®¤æ„é€ å‡½æ•°ï¼šæ„é€ ä¸€ä¸ªä¸è¡¨ç¤ºä»»ä½•æ‰§è¡Œçº¿ç¨‹çš„çº¿ç¨‹å¯¹è±¡ï¼›
<br>(2) åˆå§‹åŒ–æ„é€ å‡½æ•° æ¨¡æ¿å‡½æ•°ï¼šæ„é€ ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡ï¼Œè¯¥å¯¹è±¡è¡¨ç¤ºä¸€ä¸ªæ–°çš„å¯æ¥åˆçº¿ç¨‹ï¼Œæ–°çš„æ‰§è¡Œçº¿ç¨‹è°ƒç”¨fnä¼ é€’argsä½œä¸ºå‚æ•°(ä½¿ç”¨å…¶lvalueæˆ–rvalueå¼•ç”¨çš„è¡°å˜å‰¯æœ¬)ã€‚æ­¤æ„é€ çš„å®Œæˆå¼€å§‹åŒæ­¥è°ƒç”¨fnå‰¯æœ¬ï¼›
<br>(3) æ‹·è´æ„é€ ï¼šä¸å…è®¸æ‹·è´æ„é€ 
<br>(4) ç§»åŠ¨æ„é€ ï¼šæ„é€ çº¿ç¨‹è·å–xçº¿ç¨‹ï¼Œè¿™ä¸ªæ“ä½œä¸å½±å“ç§»åŠ¨çº¿ç¨‹çš„æ‰§è¡Œï¼Œå®ƒåªä¼šä¼ è¾“å®ƒçš„å¤„ç†ç¨‹åºï¼Œå®Œæˆxåå°†ä¸å†è¡¨ç¤ºä¸€ä¸ªçº¿ç¨‹ã€‚
<br>
<br> ğŸ¯ ææ„å‡½æ•°(destructor)
<br>std::thread::~thread ç ´åäº†çº¿ç¨‹å¯¹è±¡ï¼Œå¦‚æœåœ¨é”€æ¯æ—¶çº¿ç¨‹æ˜¯å¯æ¥åˆçš„ï¼Œåˆ™è°ƒç”¨ç»ˆæ­¢()ã€‚
<br>
<br> ğŸ¯ std::thread::operator=
<br> move (1) thread&amp; operator= (thread&amp;&amp; rhs) noexceptï¼›
<br> copy [deleted] (2) thread&amp; operator= (const thread&amp;) = delete;
<br>threadä¸å…è®¸æ‹·è´ï¼›å¦‚æœå¯¹è±¡å½“å‰ä¸æ˜¯joinableçš„ï¼Œå®ƒå°†è·å¾—ç”±rhs(å¦‚æœæœ‰çš„è¯)è¡¨ç¤ºçš„æ‰§è¡Œçº¿ç¨‹ã€‚å¦‚æœæ˜¯joinableï¼Œåˆ™è°ƒç”¨ç»ˆæ­¢()ã€‚èµ‹å€¼â€œ=â€è¿ç®—ç¬¦é€šè¿‡å³å€¼è¡¨è¾¾å¼ï¼Œå¤åˆ¶åçš„threadå¯¹è±¡ä¸å†æ˜¯ä¸€ä¸ªçº¿ç¨‹ã€‚
<br>
<br> ğŸ¯ std::thread::get_id()
<br>å¦‚æœçº¿ç¨‹å¯¹è±¡æ˜¯joinableï¼Œå‡½æ•°å°†è¿”å›å”¯ä¸€æ ‡è¯†çº¿ç¨‹çš„å€¼
<br>å¦‚æœçº¿ç¨‹å¯¹è±¡æ˜¯éjoinableï¼Œå‡½æ•°å°†è¿”å›æˆå‘˜ç±»å‹çº¿ç¨‹çš„é»˜è®¤æ„é€ å¯¹è±¡ID
<br>
<br> ğŸ¯ std::thread::sleep_for() æˆ– std::thread::sleep_until()
<br>çº¿ç¨‹å†…éƒ¨æš‚åœå‡½æ•°
<br>sleep 500æ¯«ç§’ï¼šstd::this_thread::sleep_for(milliseconds(500));
<br>sleepåˆ°æŒ‡å®šäº‹ä»¶ç‚¹ï¼šstd::this_thread::sleep_until(system_clock::now() + milliseconds(500));
<br>
<br> ğŸ¯ std::thread::joinable()
<br>è¿”å›çº¿ç¨‹å¯¹è±¡æ˜¯å¦å¯joinable
<br>å¦‚æœçº¿ç¨‹å¯¹è±¡è¡¨ç¤ºæ‰§è¡Œçº¿ç¨‹ï¼Œåˆ™æ˜¯å¯joinable
<br>åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œä¸€ä¸ªçº¿ç¨‹å¯¹è±¡æ˜¯ä¸å¯è¿æ¥çš„
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å¦‚æœæ˜¯é»˜è®¤æ„é€ 
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å¦‚æœå®ƒå·²ç»è¢«ç§»åŠ¨æˆ–è€…æ„é€ å¦ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡ï¼Œæˆ–è€…åˆ†é…ç»™å®ƒ
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å¦‚æœå®ƒçš„æˆå‘˜åŠ å…¥æˆ–åˆ†ç¦»è¢«è°ƒç”¨
<br>
<br> ğŸ¯ std::thread::join()
<br>join å‡½æ•°åœ¨çº¿ç¨‹æ‰§è¡Œå®Œæˆçš„æ—¶å€™è¿”å›
<br>æ­¤å‡½æ•°åœ¨å‡½æ•°è¿”å›æ—¶ä¸çº¿ç¨‹ä¸­æ‰€æœ‰æ“ä½œçš„å®Œæˆæ˜¯åŒæ­¥çš„
<br>è°ƒç”¨joinç›´åˆ°joinè¢«æ„é€ å‡½æ•°è°ƒç”¨è¿”å›é—´ï¼Œé˜»å¡è°ƒç”¨çš„çº¿ç¨‹
<br>åœ¨è°ƒç”¨æ­¤å‡½æ•°ä¹‹åï¼Œçº¿ç¨‹å¯¹è±¡å˜å¾—ä¸å¯è¿æ¥ï¼Œå¯ä»¥å®‰å…¨åœ°é”€æ¯
<br>
<br> ğŸ¯ std::thread::detach()
<br>åˆ†ç¦»å‡ºè°ƒç”¨çº¿ç¨‹å¯¹è±¡æ‰€ä»£è¡¨çš„çº¿ç¨‹ï¼Œå…è®¸å®ƒä»¬å½¼æ­¤ç‹¬ç«‹åœ°æ‰§è¡Œ
<br>è¿™ä¸¤ä¸ªçº¿ç¨‹åœ¨ä»»ä½•æ–¹å¼ä¸Šéƒ½ä¸é˜»å¡æˆ–åŒæ­¥
<br>åœ¨è°ƒç”¨æ­¤å‡½æ•°ä¹‹åï¼Œçº¿ç¨‹å¯¹è±¡å˜å¾—ä¸å¯è¿æ¥ï¼Œå¯ä»¥å®‰å…¨åœ°é”€æ¯
<br>æ³¨ï¼šdetachä»¥åå°±å¤±å»äº†å¯¹çº¿ç¨‹çš„æ‰€æœ‰æƒï¼Œä¸èƒ½å†è°ƒç”¨joinäº†ï¼Œå½“ä¸€ä¸ªç»“æŸæ‰§è¡Œæ—¶ï¼Œå®ƒçš„èµ„æºè¢«é‡Šæ”¾
<br>è¡¥å……ï¼šåˆ¤æ–­çº¿ç¨‹æ˜¯å¦è¿˜æœ‰å¯¹çº¿ç¨‹çš„æ‰€æœ‰æƒçš„ä¸€ä¸ªç®€å•æ–¹å¼æ˜¯è°ƒç”¨joinableå‡½æ•°ï¼Œè¿”å›trueåˆ™æœ‰ï¼Œå¦åˆ™ä¸ºæ— 
<br>
<br> ğŸ¯ std::thread::swap()
<br>void swap (thread&amp; x) noexcept;  // ä¸Xäº¤æ¢å¯¹è±¡çŠ¶æ€
<br>
<br> ğŸ¯ std::thread::native_handle()
<br>è·å–æœ¬åœ°å¤„ç†å‡½æ•°
<br>å¦‚æœåº“å®ç°æ”¯æŒï¼Œè¿™ä¸ªæˆå‘˜å‡½æ•°åªå­˜åœ¨äºç±»çº¿ç¨‹ä¸­
<br>å¦‚æœå­˜åœ¨ï¼Œå®ƒå°†è¿”å›ç”¨äºè®¿é—®ä¸çº¿ç¨‹å…³è”çš„ç‰¹å®šäºå®ç°çš„ä¿¡æ¯çš„å€¼
<br>
<br> ğŸ¯ std::thread::hardware_concurrency()
<br>static unsigned hardware_concurrency() noexcept; //å‡½æ•°å®šä¹‰
<br>æ£€æµ‹ç¡¬ä»¶å¹¶å‘ï¼Œè¿”å›ç¡¬ä»¶çº¿ç¨‹ä¸Šä¸‹æ–‡çš„æ•°é‡
<br>å¯¹è¿™ä¸ªå€¼çš„è§£é‡Šæ˜¯çœ‹å…·ä½“çš„ç³»ç»Ÿå’Œå®ç°ï¼Œå¯èƒ½ä¸æ˜¯ç²¾ç¡®çš„ï¼Œåªæ˜¯ä¸€ä¸ªè¿‘ä¼¼å€¼
<br>æ³¨ï¼šè¿™å¹¶ä¸éœ€è¦åŒ¹é…ç³»ç»Ÿä¸­å¯ç”¨çš„å¤„ç†å™¨æˆ–å†…æ ¸çš„å®é™…æ•°ç›®:ä¸€ä¸ªç³»ç»Ÿå¯ä»¥æ”¯æŒæ¯ä¸ªå¤„ç†å•å…ƒçš„å¤šä¸ªçº¿ç¨‹ï¼Œæˆ–è€…é™åˆ¶å¯¹ç¨‹åºçš„èµ„æºçš„è®¿é—®ï¼Œå¦‚æœæ­¤å€¼æ²¡æœ‰è®¡ç®—æˆ–è¢«å®šä¹‰å¥½ï¼Œåˆ™å‡½æ•°è¿”å›0ã€‚
<br>
<br> ğŸ¯ std::swap(thread)
<br>std::swap è·Ÿå‰é¢æåˆ°çš„æˆå‘˜å‡½æ•°æœ‰æ‰€ä¸åŒï¼Œä»–ä¸æ˜¯æˆå‘˜å‡½æ•°
<br>å‡½æ•°å®šä¹‰ï¼švoid swap (thread&amp; x, thread&amp; y) noexcept;
<br>äº¤æ¢çº¿ç¨‹å¯¹è±¡xå’Œyçš„çŠ¶æ€ï¼›å°±åƒx.swap(y)è¢«è°ƒç”¨
<br>
<br> ğŸ“ ç¨‹åºç¤ºä¾‹ï¼š
<br><div style="width:100%;border:1px #e3e3e3 solid;"><div style="width:100%;font-family:'Consolas', 'Courier New';font-size:12px;border-bottom:1px solid #e3e3e3;margin-top:5px;color:#000000;">&nbsp;C++ Code&nbsp;</div><table style="width:100%;font-family:'Consolas', 'Courier New';font-size:12px;vertical-align:text-top;line-height:15px;" border="0" cellspacing="0" cellpadding="0"><tr><td style="color:#008284;background-color:#e3e3e3;vertical-align:text-top;"><div style="margin:7px;text-align:right;white-space:nowrap;"><nobr>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>61<br>62<br>63<br>64<br>65<br>66<br>67<br>68<br>69<br>70<br>71<br>72<br>73<br>74<br>75<br>76<br>77<br>78<br>79<br>80<br>81<br>82<br>83<br>84<br>85<br>86<br>87<br>88<br>89<br>90<br>91<br>92<br>93<br>94<br>95<br>96<br>97<br>98<br>99<br>100<br>101<br>102<br>103<br>104<br>105<br>106<br>107<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>136<br>137<br>138<br>139<br>140<br>141<br>142<br></nobr></div></td><td style="background-color:#008284;padding:1px;"><div style="border:1px #008284 solid;"></div></td><td style="background-color:#efefef;width:100%;vertical-align:text-top;color:#000000;"><div style="margin:7px;"><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;iostream&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;vector&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;thread&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;atomic&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;chrono&gt;<BR>
</span><span style="color:#0000ff;">using</span><span style="color:#000000;">&nbsp;</span><span style="color:#0000ff;">namespace</span><span style="color:#000000;">&nbsp;std;<BR>
<BR>
atomic&lt;</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&gt;&nbsp;global_counter(</span><span style="color:#ff0000;">0</span><span style="color:#000000;">);<BR>
<BR>
thread::id&nbsp;main_thread_id&nbsp;=&nbsp;this_thread::get_id();<BR>
<BR>
</span><span style="color:#0000ff;">class</span><span style="color:#000000;">&nbsp;Greet<BR>
{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;str{&nbsp;</span><span style="color:#800000;">&quot;Great&quot;</span><span style="color:#000000;">&nbsp;};<BR>
</span><span style="color:#0000ff;">public</span><span style="color:#000000;">:<BR>
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">void</span><span style="color:#000000;">&nbsp;Say(string&nbsp;name)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;class&nbsp;Great&nbsp;is&nbsp;called&nbsp;&quot;</span><span style="color:#000000;">;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;Hello&nbsp;&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;name&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;\n&quot;</span><span style="color:#000000;">;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
};<BR>
<BR>
</span><span style="color:#0000ff;">struct</span><span style="color:#000000;">&nbsp;C:atomic&lt;</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&gt;<BR>
{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;C():atomic&lt;</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&gt;(</span><span style="color:#ff0000;">0</span><span style="color:#000000;">){}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">void</span><span style="color:#000000;">&nbsp;increase_member(</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;n)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">for</span><span style="color:#000000;">&nbsp;(</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;i&nbsp;=&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">;&nbsp;i&nbsp;&lt;&nbsp;n;&nbsp;++i)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fetch_add(</span><span style="color:#ff0000;">1</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
};<BR>
<BR>
</span><span style="color:#8000ff;">void</span><span style="color:#000000;">&nbsp;mythread()&nbsp;{}<BR>
<BR>
</span><span style="color:#8000ff;">void</span><span style="color:#000000;">&nbsp;foo(){&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;foo&nbsp;is&nbsp;called\n&quot;</span><span style="color:#000000;">;&nbsp;}<BR>
<BR>
</span><span style="color:#8000ff;">void</span><span style="color:#000000;">&nbsp;bar(</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;x)&nbsp;{&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;bar&nbsp;is&nbsp;called\n&quot;</span><span style="color:#000000;">;&nbsp;}<BR>
<BR>
</span><span style="color:#8000ff;">void</span><span style="color:#000000;">&nbsp;increase_global(</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;n)&nbsp;<BR>
{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">for</span><span style="color:#000000;">&nbsp;(</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;i&nbsp;=&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">;&nbsp;i&nbsp;&lt;&nbsp;n;&nbsp;++i)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++global_counter;<BR>
}<BR>
<BR>
</span><span style="color:#8000ff;">void</span><span style="color:#000000;">&nbsp;increase_reference<BR>
(atomic&lt;</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&gt;&amp;&nbsp;variable,&nbsp;</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;n)<BR>
{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">for</span><span style="color:#000000;">&nbsp;(</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;i&nbsp;=&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">;&nbsp;i&nbsp;&lt;&nbsp;n;&nbsp;++i)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++variable;<BR>
}<BR>
<BR>
</span><span style="color:#8000ff;">void</span><span style="color:#000000;">&nbsp;pause_thread(</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;n)<BR>
{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;this_thread::sleep_for(chrono::seconds(n));<BR>
&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;pause&nbsp;of&nbsp;&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;n&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;&nbsp;seconds&nbsp;ended\n&quot;</span><span style="color:#000000;">;<BR>
}<BR>
<BR>
</span><span style="color:#8000ff;">void</span><span style="color:#000000;">&nbsp;is_main_thread()<BR>
{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(main_thread_id&nbsp;==&nbsp;this_thread::get_id())<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;This&nbsp;is&nbsp;the&nbsp;main&nbsp;thread.\n&quot;</span><span style="color:#000000;">;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">else</span><span style="color:#000000;"><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;This&nbsp;is&nbsp;not&nbsp;the&nbsp;main&nbsp;thread.\n&quot;</span><span style="color:#000000;">;<BR>
}<BR>
<BR>
</span><span style="color:#0000ff;">auto</span><span style="color:#000000;">&nbsp;main()&nbsp;-&gt;&nbsp;</span><span style="color:#8000ff;">int</span><span style="color:#000000;"><BR>
{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#008000;">//&nbsp;æ„é€ å‡½æ•°ä½¿ç”¨ç¤ºä¾‹<BR>
</span><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;Greet&nbsp;greet;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;thread&nbsp;first(foo);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;thread&nbsp;second(bar,&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#008000;">//&nbsp;ç±»æˆå‘˜å‡½æ•°ä½œä¸ºçº¿ç¨‹å…¥å£<BR>
</span><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;thread&nbsp;third(&amp;Greet::Say,&nbsp;&amp;greet,&nbsp;</span><span style="color:#800000;">&quot;greet&quot;</span><span style="color:#000000;">);<BR>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;vector&lt;thread&gt;&nbsp;threads;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;increase&nbsp;global&nbsp;counter&nbsp;with&nbsp;10&nbsp;threads...\n&quot;</span><span style="color:#000000;">;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">for</span><span style="color:#000000;">&nbsp;(</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;i&nbsp;=&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">;&nbsp;i&nbsp;&lt;&nbsp;</span><span style="color:#ff0000;">10</span><span style="color:#000000;">;&nbsp;++i)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;threads.push_back(thread(increase_global,&nbsp;</span><span style="color:#ff0000;">1000</span><span style="color:#000000;">));<BR>
&nbsp;&nbsp;&nbsp;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;increase&nbsp;counter&nbsp;(ato)&nbsp;with&nbsp;10&nbsp;threads&quot;</span><span style="color:#000000;"><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#800000;">&quot;&nbsp;using&nbsp;reference...\n&quot;</span><span style="color:#000000;">;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;atomic&lt;</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&gt;&nbsp;ato(</span><span style="color:#ff0000;">0</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">for</span><span style="color:#000000;">&nbsp;(</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;i&nbsp;=&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">;&nbsp;i&nbsp;&lt;&nbsp;</span><span style="color:#ff0000;">10</span><span style="color:#000000;">;&nbsp;++i)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;threads.push_back(thread(increase_reference,<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ref(ato),&nbsp;</span><span style="color:#ff0000;">1000</span><span style="color:#000000;">));<BR>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;C&nbsp;cba;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">for</span><span style="color:#000000;">&nbsp;(</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;i&nbsp;=&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">;&nbsp;i&nbsp;&lt;&nbsp;</span><span style="color:#ff0000;">10</span><span style="color:#000000;">;&nbsp;++i)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;threads.push_back(thread(&amp;C::increase_member,<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ref(cba),&nbsp;</span><span style="color:#ff0000;">1000</span><span style="color:#000000;">));<BR>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#008000;">//&nbsp;std::thread::operator=&nbsp;ç¤ºä¾‹<BR>
</span><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;thread&nbsp;threads1[</span><span style="color:#ff0000;">5</span><span style="color:#000000;">];<BR>
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">for</span><span style="color:#000000;">&nbsp;(</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;i&nbsp;=&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">;&nbsp;i&nbsp;&lt;&nbsp;</span><span style="color:#ff0000;">5</span><span style="color:#000000;">;&nbsp;++i)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;threads1[i]&nbsp;=&nbsp;thread(pause_thread,&nbsp;i&nbsp;+&nbsp;</span><span style="color:#ff0000;">1</span><span style="color:#000000;">);<BR>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#008000;">//&nbsp;std::thread::get_id()&nbsp;ç¤ºä¾‹<BR>
</span><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;thread&nbsp;th(is_main_thread);<BR>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#008000;">//&nbsp;std::thread::joinable()&nbsp;ç¤ºä¾‹<BR>
</span><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;thread&nbsp;th1(mythread);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;thread&nbsp;th2;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;Joinable&nbsp;after&nbsp;construction:\n&quot;</span><span style="color:#000000;">;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;boolalpha&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;th1:&nbsp;&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;th1.joinable()&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;boolalpha&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;th2:&nbsp;&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;th2.joinable()&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(th1.joinable())&nbsp;th1.join();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(th2.joinable())&nbsp;th2.join();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;Joinable&nbsp;after&nbsp;joining:\n&quot;</span><span style="color:#000000;">;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;boolalpha&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;th1:&nbsp;&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;th1.joinable()&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;boolalpha&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;th2:&nbsp;&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;th2.joinable()&nbsp;&lt;&lt;&nbsp;endl;<BR>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#008000;">//&nbsp;std::thread::join<BR>
</span><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;synchronizing&nbsp;all&nbsp;threads...\n&quot;</span><span style="color:#000000;">;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;Done&nbsp;spawning&nbsp;threads.&nbsp;&quot;</span><span style="color:#000000;"><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#800000;">&quot;Now&nbsp;waiting&nbsp;for&nbsp;them&nbsp;to&nbsp;join:\n&quot;</span><span style="color:#000000;">;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;first.join();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;second.join();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;third.join();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">for</span><span style="color:#000000;">&nbsp;(</span><span style="color:#0000ff;">auto</span><span style="color:#000000;">&amp;&nbsp;th&nbsp;:&nbsp;threads)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;th.join();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">for</span><span style="color:#000000;">&nbsp;(</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;i&nbsp;=&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">;&nbsp;i&nbsp;&lt;&nbsp;</span><span style="color:#ff0000;">5</span><span style="color:#000000;">;&nbsp;++i)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;threads1[i].join();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;th.join();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;All&nbsp;threads&nbsp;joined!\n&quot;</span><span style="color:#000000;">;<BR>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#008000;">//&nbsp;è¾“å‡ºç»“æœ<BR>
</span><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;global_counter:&nbsp;&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;global_counter&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;\n&quot;</span><span style="color:#000000;">;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;ato:&nbsp;&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;ato&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;\n&quot;</span><span style="color:#000000;">;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;cba:&nbsp;&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;cba&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;\n&quot;</span><span style="color:#000000;">;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#008000;">//&nbsp;std::thread::detach()&nbsp;ç¤ºä¾‹<BR>
</span><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;Spawning&nbsp;and&nbsp;detaching&nbsp;3&nbsp;threads...\n&quot;</span><span style="color:#000000;">;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;thread(pause_thread,&nbsp;</span><span style="color:#ff0000;">1</span><span style="color:#000000;">).detach();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;thread(pause_thread,&nbsp;</span><span style="color:#ff0000;">2</span><span style="color:#000000;">).detach();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;thread(pause_thread,&nbsp;</span><span style="color:#ff0000;">3</span><span style="color:#000000;">).detach();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;Done&nbsp;spawning&nbsp;threads.\n&quot;</span><span style="color:#000000;">;<BR>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;the&nbsp;main&nbsp;thread&nbsp;will&nbsp;now&nbsp;pause&nbsp;for&nbsp;5&nbsp;seconds\n&quot;</span><span style="color:#000000;">;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;pause_thread(</span><span style="color:#ff0000;">5</span><span style="color:#000000;">);<BR>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">return</span><span style="color:#000000;">&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">;<BR>
}</span></div></td></tr></table></div>
<br> ğŸ è¾“å‡º
<br><div style="width:100%;border:1px #e3e3e3 solid;"><div style="width:100%;font-family:'Consolas', 'Courier New';font-size:12px;border-bottom:1px solid #e3e3e3;margin-top:5px;color:#000000;">&nbsp;C++ Code&nbsp;</div><table style="width:100%;font-family:'Consolas', 'Courier New';font-size:12px;vertical-align:text-top;line-height:15px;" border="0" cellspacing="0" cellpadding="0"><tr><td style="color:#008284;background-color:#e3e3e3;vertical-align:text-top;"><div style="margin:7px;text-align:right;white-space:nowrap;"><nobr>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br></nobr></div></td><td style="background-color:#008284;padding:1px;"><div style="border:1px #008284 solid;"></div></td><td style="background-color:#efefef;width:100%;vertical-align:text-top;color:#000000;"><div style="margin:7px;">increase&nbsp;global&nbsp;counter&nbsp;with&nbsp;<span style="color:#ff0000;">10</span><span style="color:#000000;">&nbsp;threads...<BR>
increase&nbsp;counter&nbsp;(ato)&nbsp;with&nbsp;</span><span style="color:#ff0000;">10</span><span style="color:#000000;">&nbsp;threads&nbsp;</span><span style="color:#0000ff;">using</span><span style="color:#000000;">&nbsp;reference...<BR>
Joinable&nbsp;after&nbsp;construction:<BR>
th1:&nbsp;</span><span style="color:#0000ff;">true</span><span style="color:#000000;"><BR>
th2:&nbsp;</span><span style="color:#0000ff;">false</span><span style="color:#000000;"><BR>
foo&nbsp;is&nbsp;called<BR>
</span><span style="color:#0000ff;">class</span><span style="color:#000000;">&nbsp;Great&nbsp;is&nbsp;called&nbsp;Hello&nbsp;greet<BR>
bar&nbsp;is&nbsp;called<BR>
This&nbsp;is&nbsp;</span><span style="color:#0000ff;">not</span><span style="color:#000000;">&nbsp;the&nbsp;main&nbsp;thread.<BR>
Joinable&nbsp;after&nbsp;joining:<BR>
th1:&nbsp;</span><span style="color:#0000ff;">false</span><span style="color:#000000;"><BR>
th2:&nbsp;</span><span style="color:#0000ff;">false</span><span style="color:#000000;"><BR>
synchronizing&nbsp;all&nbsp;threads...<BR>
Done&nbsp;spawning&nbsp;threads.&nbsp;Now&nbsp;waiting&nbsp;</span><span style="color:#0000ff;">for</span><span style="color:#000000;">&nbsp;them&nbsp;to&nbsp;join:<BR>
pause&nbsp;of&nbsp;</span><span style="color:#ff0000;">1</span><span style="color:#000000;">&nbsp;seconds&nbsp;ended<BR>
pause&nbsp;of&nbsp;</span><span style="color:#ff0000;">2</span><span style="color:#000000;">&nbsp;seconds&nbsp;ended<BR>
pause&nbsp;of&nbsp;</span><span style="color:#ff0000;">3</span><span style="color:#000000;">&nbsp;seconds&nbsp;ended<BR>
pause&nbsp;of&nbsp;</span><span style="color:#ff0000;">4</span><span style="color:#000000;">&nbsp;seconds&nbsp;ended<BR>
pause&nbsp;of&nbsp;</span><span style="color:#ff0000;">5</span><span style="color:#000000;">&nbsp;seconds&nbsp;ended<BR>
All&nbsp;threads&nbsp;joined!<BR>
global_counter:&nbsp;</span><span style="color:#ff0000;">10000</span><span style="color:#000000;"><BR>
ato:&nbsp;</span><span style="color:#ff0000;">10000</span><span style="color:#000000;"><BR>
cba:&nbsp;</span><span style="color:#ff0000;">10000</span><span style="color:#000000;"><BR>
Spawning&nbsp;</span><span style="color:#0000ff;">and</span><span style="color:#000000;">&nbsp;detaching&nbsp;</span><span style="color:#ff0000;">3</span><span style="color:#000000;">&nbsp;threads...<BR>
Done&nbsp;spawning&nbsp;threads.<BR>
the&nbsp;main&nbsp;thread&nbsp;will&nbsp;now&nbsp;pause&nbsp;</span><span style="color:#0000ff;">for</span><span style="color:#000000;">&nbsp;</span><span style="color:#ff0000;">5</span><span style="color:#000000;">&nbsp;seconds<BR>
pause&nbsp;of&nbsp;</span><span style="color:#ff0000;">1</span><span style="color:#000000;">&nbsp;seconds&nbsp;ended<BR>
pause&nbsp;of&nbsp;</span><span style="color:#ff0000;">2</span><span style="color:#000000;">&nbsp;seconds&nbsp;ended<BR>
pause&nbsp;of&nbsp;</span><span style="color:#ff0000;">3</span><span style="color:#000000;">&nbsp;seconds&nbsp;ended<BR>
pause&nbsp;of&nbsp;</span><span style="color:#ff0000;">5</span><span style="color:#000000;">&nbsp;seconds&nbsp;ended<BR>
<BR>
A:\C++\C++11\å¤šçº¿ç¨‹\Debug\å¤šçº¿ç¨‹.exe&nbsp;(è¿›ç¨‹&nbsp;</span><span style="color:#ff0000;">12072</span><span style="color:#000000;">)å·²é€€å‡ºï¼Œä»£&nbsp;ç ä¸º&nbsp;0ã€‚</span></div></td></tr></table></div>
<br><br><br>
<font color = gray size = 3>å¦‚æœ‰é”™è¯¯ï¼Œæ¬¢è¿æŒ‡æ­£ï¼</font></p></div>
        <div class="post_footer">
          
          <div class="meta">
            <div class="info">
              <span class="field tags">
                <i class="remixicon-stack-line"></i>
                
                <a href="https://oubc.github.io/tags/c/c&#43;&#43;/">C/C&#43;&#43;</a>
                
              </span>
            </div>
          </div>
          
        </div>
      </div>
      
      
    </div>
  </div>
  <a id="back_to_top" href="#" class="back_to_top"><span>â–³</span></a>
</div>
<footer class="footer">
  <div class="powered_by">
    <a href="https://wxt.sinaimg.cn/thumb300/007Diza3ly1g4l9lmg4aog3074074gnf.gif?tags=%5B%5D">I </a>
	<a href="">love</a>
    <a href="https://wxt.sinaimg.cn/thumb300/007Diza3ly1g4l9lmfm2eg306o06o74u.gif?tags=%5B%5D"> you </a>
    <a href="https://wxt.sinaimg.cn/thumb300/007Diza3ly1g4njrx4tpcj30fn0bq3zg.jpg?tags=%5B%5D">three </a>
	<a href="https://wxt.sinaimg.cn/thumb300/007Diza3ly1g4njrx64ctg307s07swfy.gif?tags=%5B%5D">thousand</a>
    <a href="https://www.kugou.com/song/#hash=96426C78381DE98DC31A5846FC274CBF&album_id=646623"> times.</a>
  </div>

  <div class="footer_slogan">
    <span>å®¶åº­ã€æ¢¦æƒ³ã€å†…å¿ƒçš„å¹³é™</span>
  </div>
</footer>



<script src="https://oubc.github.io/js/jquery-3.3.1.min.js"></script>
<script src="https://oubc.github.io/js/zozo.js"></script>
<script src="https://oubc.github.io/js/highlight.pack.js"></script>
<link  href="https://oubc.github.io/css/fancybox.min.css" rel="stylesheet">
<script src="https://oubc.github.io/js/fancybox.min.js"></script>

<script>hljs.initHighlightingOnLoad()</script>


  <script type="text/javascript" async src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[\[','\]\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});

MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<style>
code.has-jax {
    font: inherit;
    font-size: 100%;
    background: inherit;
    border: inherit;
    color: #515151;
}
</style>






</body>
</html>
