<!DOCTYPE html>
<html lang="zh-cn" >
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>

  
  <meta name="author"
        content="Bruce Cheung"/>

  
  <meta name="description" content=""/>
  

  
  
  <meta name="keywords" content="blog, simple, dream"/>
  

  
  <link rel="canonical" href="https://oubc.github.io/post/l16_oscode1/"/>

  

  <title>Linuxç³»ç»Ÿç¼–ç¨‹ (è¿›ç¨‹é—´é€šä¿¡:IPC) &middot; Love, or death</title>

  <link rel="shortcut icon" href="https://oubc.github.io/images/favicon.ico"/>
  <link rel="stylesheet" href="https://oubc.github.io/css/animate.min.css"/>
  <link rel="stylesheet" href="https://oubc.github.io/css/remixicon.css"/>
  <link rel="stylesheet" href="https://oubc.github.io/css/zozo.css"/>
  <link rel="stylesheet" href="https://oubc.github.io/css/highlight.css"/>

  
  
</head>

<body>
<div class="main animated">
  <div class="nav_container animated fadeInDown">
  <div class="site_nav" id="site_nav">
    <ul>
      
      <li>
        <a href="/">é¦–é¡µ</a>
      </li>
      
      <li>
        <a href="/post/">å½’æ¡£</a>
      </li>
      
      <li>
        <a href="/tags/">æ ‡ç­¾</a>
      </li>
      
      <li>
        <a href="/about/">å…³äº</a>
      </li>
      
    </ul>
  </div>
  <div class="menu_icon">
    <a id="menu_icon"><i class="remixicon-links-line"></i></a>
  </div>
</div>

  <div class="header animated fadeInDown">
  <div class="site_title_container">
    <div class="site_title">
      <h1>
        <a href="https://oubc.github.io/">
          <span>Love, or death</span>
          <img src="https://oubc.github.io/images/logo.svg"/>
        </a>
      </h1>
    </div>
    <div class="description">
      <p class="sub_title">For you, a thousand times over.</p>
      <div class="my_socials">
        
        
        <a href="https://github.com/oubc" title="github" target="_blank"><i class="remixicon-github-fill"></i></a>
        
        
        
        <a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=uYGOjo6OiIuLivnIyJfa1tQ" title="mail" target="_blank"><i class="remixicon-mail-fill"></i></a>
        
        
        
        <a href="http://sighttp.qq.com/msgrd?v=1&amp;uin=877771223" title="qq" target="_blank"><i class="remixicon-qq-fill"></i></a>
        
        
        
        <a href="https://github.com/oubc/oubc.github.io/blob/master/images/wx.jpg?raw=true" title="wechat" target="_blank"><i class="remixicon-wechat-fill"></i></a>
        
        
        
        <a href="https://weibo.com/u/6993631995?topnav=1&amp;wvr=6&amp;topsug=1" title="weibo" target="_blank"><i class="remixicon-weibo-fill"></i></a>
        
        
        <a href="https://oubc.github.io/index.xml" type="application/rss+xml" title="rss" target="_blank"><i class="remixicon-rss-fill"></i></a>
      </div>
    </div>
  </div>
</div>

  <div class="content">
    <div class="post_page">
      <div class="post animated fadeInDown">
        <div class="post_title post_detail_title">
          <h2><a href='/post/l16_oscode1/'>Linuxç³»ç»Ÿç¼–ç¨‹ (è¿›ç¨‹é—´é€šä¿¡:IPC)</a></h2>
          <span class="date">2019.09.24</span>
        </div>
        <div class="post_content markdown"><p><br>
<br>åœ¨è¿›ç¨‹é—´å®Œæˆæ•°æ®ä¼ é€’éœ€è¦å€ŸåŠ©æ“ä½œç³»ç»Ÿæä¾›ç‰¹æ®Šçš„æ–¹æ³•ï¼Œå¦‚ï¼šæ–‡ä»¶ã€ç®¡é“ã€ä¿¡å·ã€å…±äº«å†…å®¹ã€æ¶ˆæ¯é˜Ÿåˆ—ã€å¥—æ¥å­—ã€å‘½ä»¤ç®¡é“ç­‰ï¼Œéšç€è®¡ç®—æœºçš„è“¬å‹ƒå‘å±•ï¼Œä¸€äº›æ–¹æ³•ç”±äºè‡ªèº«è®¾è®¡ç¼ºé™·è¢«æ·˜æ±°æˆ–è€…å¼ƒç”¨ï¼Œç°ä»Šå¸¸ç”¨çš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼æœ‰ï¼š
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1ã€ç®¡é“ (ä½¿ç”¨æœ€ç®€å•)
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2ã€ä¿¡å· (å¼€é”€æœ€å°)
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3ã€å…±äº«æ˜ å°„åŒº (æ— è¡€ç¼˜å…³ç³»)
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4ã€æœ¬åœ°å¥—æ¥å­— (æœ€ç¨³å®š)
<br>
<br><a href="#recap">å‰æƒ…çŸ¥è¯†ç‚¹</a>
<br><font color = gray size = 2>åˆ—è¡¨ï¼Œå±•å¼€ç‚¹å‡»è·³è½¬</font>
<br>
<details class="menu" close>
      <summary><font color=blue size = 4>ç®¡é“</font></summary>
      <ul>
          <li><a href="#bc0">ç®¡é“çš„æ¦‚å¿µ</a></li>
          <li><a href="#bc1">pipe() å‡½æ•°</a></li>
          <li><a href="#bc2">æŒæ¡ç®¡é“ä¸€èˆ¬è¯»å†™è¡Œä¸º</a></li>
      </ul>
</details>
<details class="menu" close>
      <summary><font color=blue size = 4>fifo (æœ‰åç®¡é“)</font></summary>
      <ul>
          <li><a href="#bc3">ç”¨äºéè¡€ç¼˜å…³ç³»è¿›ç¨‹é—´é€šä¿¡</a></li>
      </ul>
</details>
<details class="menu" close>
      <summary><font color=blue size = 4>å†…å­˜å…±äº«</font></summary>
      <ul>
          <li><a href="#bc4">å…±äº«å­˜å‚¨æ˜ å°„</a></li>
          <li><a href="#bc5">æ–‡ä»¶è¿›ç¨‹é—´é€šä¿¡</a></li>
          <li><a href="#bc6">å­˜å‚¨æ˜ å°„I/O</a></li>
          <li><a href="#bc7">mmap() å‡½æ•°</a></li>
          <li><a href="#bc8">mmap() çˆ¶å­è¿›ç¨‹é—´é€šä¿¡</a></li>
          <li><a href="#bc9">åŒ¿åæ˜ å°„åŒº</a></li>
          <li><a href="#bc10">ç”¨äºéè¡€ç¼˜å…³ç³»è¿›ç¨‹é—´é€šä¿¡</a></li>
          <li><a href="#bc11">å®ç°æ–‡ä»¶å¤šè¿›ç¨‹æ‹·è´</a></li>
      </ul>
</details>
<br>
<br>
<br>
<br>
<br><font color=black size = 4><a name="recap">å‰æƒ…çŸ¥è¯†ç‚¹</a></font>
<br> ğŸ˜„ æ®µé”™è¯¯(æ ¸å¿ƒå·²è½¬å‚¨)&nbsp;&nbsp;&nbsp; è°ƒè¯•
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åˆ©ç”¨ g++ æ–‡ä»¶å -o ç”Ÿæˆæ–‡ä»¶å -Wall -g
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åˆ©ç”¨gdb æ‰“å¼€ç”Ÿæˆæ–‡ä»¶
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ç›´æ¥runï¼Œç³»ç»Ÿå°±ä¼šè·³è½¬åˆ°æ®µé”™è¯¯ä½ç½®
<br>
<br> ğŸ˜€ denty - ç›®å½•é¡¹(ä¸€ä¸ªæ–‡ä»¶å¯¹åº”ä¸€ä¸ªç›®å½•é¡¹)ï¼š
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æ–‡ä»¶å
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inodeç¼–å·
<br>
<br> ğŸ˜Š inode -&gt; å±æ€§
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; struct stat{
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æ–‡ä»¶å­˜å‚¨æŒ‡é’ˆåœ°å€ -&gt; æŒ‡å‘æ•°æ®å—é¦–åœ°å€
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æ–‡ä»¶å¤§å°
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æ–‡ä»¶ç±»å‹
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æƒé™
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æ‰€æœ‰è€…ã€æ‰€å±ç»„
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ......
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
<br>
<br> ğŸ˜Š Linuxä¸­ä¸€å…±æœ‰ä¸ƒç§æ–‡ä»¶ç±»å‹ï¼š
<br>&nbsp;&nbsp;&nbsp;&nbsp; å ç”¨ç£ç›˜å­˜å‚¨çš„æ–‡ä»¶ç±»å‹
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - æ™®é€šæ–‡ä»¶
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; d ç›®å½•
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; l ç¬¦å·é“¾æ¥æ–‡ä»¶
<br>&nbsp;&nbsp;&nbsp;&nbsp; ä¸å ç”¨ç£ç›˜å­˜å‚¨çš„æ–‡ä»¶ç±»å‹ (ä¼ªæ–‡ä»¶)
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; s å¥—æ¥å­—
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; b å—è®¾å¤‡
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c å­—ç¬¦è®¾å¤‡
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; p ç®¡é“
<br>
<br> ğŸ˜Š è¿›ç¨‹é—´é€šä¿¡ (IPC)
<br>IPCæ–¹æ³•ï¼šLinuxç¯å¢ƒä¸‹ï¼Œè¿›ç¨‹åœ°å€ç©ºé—´ç›¸äº’ç‹¬ç«‹ï¼Œæ¯ä¸ªè¿›ç¨‹å„è‡ªæœ‰ä¸åŒçš„ç”¨æˆ·åœ°å€ç©ºé—´ï¼Œä»»ä½•ä¸€ä¸ªè¿›ç¨‹çš„å…¨å±€å˜é‡åœ¨å¦ä¸€ä¸ªè¿›ç¨‹ä¸­éƒ½çœ‹ä¸åˆ°ï¼Œæ‰€ä»¥è¿›ç¨‹å’Œè¿›ç¨‹ä¹‹é—´ä¸èƒ½ç›¸äº’è®¿é—®ï¼Œè¦äº¤æ¢æ•°æ®å¿…é¡»é€šè¿‡å†…æ ¸ï¼Œåœ¨å†…æ ¸ä¸­å¼€è¾Ÿä¸€å—ç¼“å†²åŒºï¼Œè¿›ç¨‹1æŠŠæ•°æ®ä»ç”¨æˆ·ç©ºé—´æ‹·è´åˆ°å†…æ ¸ç¼“å†²åŒºï¼Œè¿›ç¨‹2å†ä»å†…æ ¸ç¼“å†²åŒºæŠŠæ•°æ®è¯»èµ°ï¼Œå†…æ ¸æä¾›çš„è¿™ç§æœºåˆ¶ç§°ä¸ºè¿›ç¨‹é—´é€šä¿¡(IPC InterProcess Communication)ã€‚
<br><img src="https://github.com/oubc/oubc.github.io/blob/master/images/L16_OScode0.png?raw=true" width="800" height="450" />
<br>
<br><font color=black size = 5><a name="bc0">ç®¡é“</a></font>
<br>ç®¡é“æ˜¯ä¸€ç§åŸºæœ¬çš„IPCæœºåˆ¶ï¼Œä½œç”¨äºæœ‰è¡€ç¼˜å…³ç³»çš„è¿›ç¨‹ä¹‹é—´ï¼Œå®Œæˆæ•°æ®ä¼ é€’ï¼Œè°ƒç”¨pipeç³»ç»Ÿå‡½æ•°å³å¯åˆ›å»ºä¸€ä¸ªç®¡é“ï¼Œæœ‰å¦‚ä¸‹ç‰¹è´¨ï¼š
<br>&nbsp;&nbsp;&nbsp;&nbsp; 1ã€å…¶æœ¬è´¨æ˜¯ä¸€ä¸ªä¼ªæ–‡ä»¶
<br>&nbsp;&nbsp;&nbsp;&nbsp; 2ã€ç”±ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦å¼•ç”¨ï¼Œä¸€ä¸ªè¡¨ç¤ºè¯»ç«¯ï¼Œä¸€ä¸ªè¡¨ç¤ºå†™ç«¯
<br>&nbsp;&nbsp;&nbsp;&nbsp; 3ã€è§„å®šæ•°æ®ä»ç®¡é“çš„å†™ç«¯æµå…¥ç®¡é“ï¼Œä»è¯»ç«¯æµå‡º
<br> ğŸ˜Š ç®¡é“çš„åŸç†ï¼Œç®¡é“å®ä¸ºå†…æ ¸ä½¿ç”¨ç¯å½¢é˜Ÿåˆ—æœºåˆ¶ï¼Œå€ŸåŠ©å†…æ ¸ç¼“å†²åŒº (4k) å®ç°
<br> ğŸ˜Š ç®¡é“çš„å±€é™æ€§ï¼š
<br>&nbsp;&nbsp;&nbsp;&nbsp; 1ã€æ•°æ®è‡ªå·±è¯»ä¸èƒ½è‡ªå·±å†™
<br>&nbsp;&nbsp;&nbsp;&nbsp; 2ã€æ•°æ®ä¸€æ—¦è¢«è¯»èµ°ï¼Œä¾¿ä¸åœ¨ç®¡é“ä¸­å­˜åœ¨ï¼Œä¸å¯åå¤è¯»å–
<br>&nbsp;&nbsp;&nbsp;&nbsp; 3ã€ç”±äºç®¡é“é‡‡ç”¨åŠåŒå·¥é€šä¿¡æ–¹å¼ï¼Œå› æ­¤ï¼Œæ•°æ®åªèƒ½åœ¨ä¸€ä¸ªæ–¹å‘ä¸ŠæµåŠ¨
<br>&nbsp;&nbsp;&nbsp;&nbsp; 4ã€åªèƒ½åœ¨ç”±å…¬å…±ç¥–å…ˆçš„è¿›ç¨‹é—´ä½¿ç”¨ç®¡é“
<br> ğŸ˜Š å¸¸è§çš„é€šä¿¡æ–¹å¼ï¼šå•å·¥é€šä¿¡ã€åŠåŒå·¥é€šä¿¡ã€å…¨åŒå·¥é€šä¿¡
<br>&nbsp;&nbsp;&nbsp;&nbsp; å•å·¥é€šä¿¡ï¼šåªèƒ½ä¸€æ–¹å‘å¦ä¸€æ–¹å‘èµ·é€šä¿¡ï¼Œå°±åƒé¥æ§å™¨ã€BBæœºç­‰
<br>&nbsp;&nbsp;&nbsp;&nbsp; åŠåŒå·¥é€šä¿¡ï¼šæ•°æ®åªèƒ½åœ¨ä¸€ä¸ªæ–¹å‘ä¸ŠæµåŠ¨
<br>&nbsp;&nbsp;&nbsp;&nbsp; åŒå‘åŠåŒå·¥ï¼šç›¸å½“äºå¾®ä¿¡è¯­éŸ³åŠŸèƒ½ï¼Œä¸€æ–¹å‘é€ï¼Œå¦ä¸€æ–¹åªèƒ½è¯»ï¼Œè¯»å®Œäº†å¦ä¸€ä¸ªå‘é€
<br>&nbsp;&nbsp;&nbsp;&nbsp; åŒå‘å…¨åŒå·¥ï¼šèƒ½å®ç°äº¤äº’ï¼Œç›¸å½“äºæ‰“ç”µè¯
<br>
<br><font color=black size = 5><a name="bc1">pipe() å‡½æ•°</a></font>
<br>åˆ›å»ºç®¡é“çš„åŒæ—¶å°†ç®¡é“ä¸¤ç«¯æ‰“å¼€
<br>&nbsp;&nbsp;&nbsp;&nbsp; int pipe(int pipefd[2]);   æˆåŠŸè¿”å›0ï¼Œå¤±è´¥è¿”å›-1ï¼Œè®¾ç½®error
<br>&nbsp;&nbsp;&nbsp;&nbsp; å‡½æ•°è°ƒç”¨æˆåŠŸè¿”å›r/wä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œæ— éœ€openï¼Œä½†éœ€æ‰‹åŠ¨close
<br>&nbsp;&nbsp;&nbsp;&nbsp; è§„å®šï¼šfd[0] -&gt; r; fd[1] -&gt; wï¼Œå°±åƒ0å¯¹åº”æ ‡å‡†è¾“å…¥ï¼Œ1å¯¹åº”æ ‡å‡†è¾“å‡ºä¸€æ ·ï¼Œå‘ç®¡é“æ–‡ä»¶è¯»å†™æ•°æ®å…¶å®æ˜¯åœ¨è¯»å†™å†…æ ¸ç¼“å†²åŒº
<br>&nbsp;&nbsp;&nbsp;&nbsp; ç®¡é“åˆ›å»ºæˆåŠŸä»¥åï¼Œåˆ›å»ºè¯¥ç®¡é“çš„è¿›ç¨‹(çˆ¶è¿›ç¨‹)åŒæ—¶æŒæ¡ç€ç®¡é“çš„è¯»ç«¯å’Œå†™ç«¯ï¼Œå®ç°çˆ¶å­è¿›ç¨‹é—´é€šä¿¡é€šå¸¸é‡‡ç”¨å¦‚ä¸‹æ­¥éª¤ï¼š
<br><div style="width:100%;border:1px #e3e3e3 solid;"><div style="width:100%;font-family:'Consolas', 'Courier New';font-size:12px;border-bottom:1px solid #e3e3e3;margin-top:5px;color:#000000;">&nbsp;C++ Code&nbsp;</div><table style="width:100%;font-family:'Consolas', 'Courier New';font-size:12px;vertical-align:text-top;line-height:15px;" border="0" cellspacing="0" cellpadding="0"><tr><td style="color:#008284;background-color:#e3e3e3;vertical-align:text-top;"><div style="margin:7px;text-align:right;white-space:nowrap;"><nobr>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br></nobr></div></td><td style="background-color:#008284;padding:1px;"><div style="border:1px #008284 solid;"></div></td><td style="background-color:#efefef;width:100%;vertical-align:text-top;color:#000000;"><div style="margin:7px;"><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;iostream&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;unistd.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;stdlib.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;string.h&gt;<BR>
</span><span style="color:#0000ff;">using</span><span style="color:#000000;">&nbsp;</span><span style="color:#0000ff;">namespace</span><span style="color:#000000;">&nbsp;std;<BR>
<BR>
</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;main()<BR>
{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pid_t&nbsp;pid;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;fd[</span><span style="color:#ff0000;">2</span><span style="color:#000000;">];<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;ret&nbsp;=&nbsp;pipe(fd);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(ret&nbsp;==&nbsp;-</span><span style="color:#ff0000;">1</span><span style="color:#000000;">)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;Pipe&nbsp;error!&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(</span><span style="color:#ff0000;">1</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pid&nbsp;=&nbsp;fork();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(pid&nbsp;==&nbsp;-</span><span style="color:#ff0000;">1</span><span style="color:#000000;">)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;Fork&nbsp;error!&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(</span><span style="color:#ff0000;">1</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">else</span><span style="color:#000000;">&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(pid&nbsp;==&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#008000;">//&nbsp;å­è¿›ç¨‹è¯»æ•°æ®<BR>
</span><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close(fd[</span><span style="color:#ff0000;">1</span><span style="color:#000000;">]);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">char</span><span style="color:#000000;">&nbsp;buf[</span><span style="color:#ff0000;">1024</span><span style="color:#000000;">];<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret&nbsp;=&nbsp;read(fd[</span><span style="color:#ff0000;">0</span><span style="color:#000000;">],&nbsp;buf,&nbsp;</span><span style="color:#0000ff;">sizeof</span><span style="color:#000000;">(buf));<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(ret&nbsp;==&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">)&nbsp;&nbsp;&nbsp;</span><span style="color:#008000;">//&nbsp;è¯»åˆ°æ–‡ä»¶æœ«å°¾<BR>
</span><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;--------&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write(STDOUT_FILENO,&nbsp;buf,&nbsp;ret);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">else</span><span style="color:#000000;"><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#008000;">//&nbsp;çˆ¶è¿›ç¨‹å†™æ•°æ®<BR>
</span><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close(fd[</span><span style="color:#ff0000;">0</span><span style="color:#000000;">]);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write(fd[</span><span style="color:#ff0000;">1</span><span style="color:#000000;">],&nbsp;</span><span style="color:#800000;">&quot;Hello&nbsp;pipe~\n&quot;</span><span style="color:#000000;">,&nbsp;strlen(</span><span style="color:#800000;">&quot;Hello&nbsp;pipe~\n&quot;</span><span style="color:#000000;">));<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleep(</span><span style="color:#ff0000;">1</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">return</span><span style="color:#000000;">&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">;<BR>
}</span></div></td></tr></table></div>
<br>
<br><font color=black size = 5><a name="bc2">ç®¡é“è¯»å†™è¡Œä¸º</a></font>
<br> ğŸ˜Š è¯»ç®¡é“ï¼š
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ç®¡é“ä¸­æœ‰æ•°æ® -&gt; readè¿”å›å®é™…è¯»åˆ°çš„å­—èŠ‚æ•°
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ç®¡é“ä¸­æ— æ•°æ® -&gt; å†™ç«¯å…¨å…³é—­ï¼šreadè¿”å›0ã€ä»æœ‰å†™ç«¯æ‰“å¼€ï¼šé˜»å¡ç­‰å¾…
<br> ğŸ˜Š å†™ç®¡é“ï¼š
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; è¯»ç«¯å…¨å…³é—­ï¼šè¿›ç¨‹å¼‚å¸¸ç»ˆæ­¢ (SIGNIPEä¿¡å·)
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æœ‰è¯»ç«¯æ‰“å¼€ï¼šç®¡é“æœªæ»¡ -&gt; å†™æ•°æ®ï¼Œè¿”å›å†™å…¥å­—èŠ‚æ•°ã€ç®¡é“ä»¥æ»¡ï¼šé˜»å¡(å°‘è§)
<br> ğŸ˜Š çˆ¶å­é—´è¿›ç¨‹é€šä¿¡ ls | wc -l
<br> ğŸ˜Š å…„å¼Ÿé—´è¿›ç¨‹é€šä¿¡
<br> ğŸ˜Š è·å–ç®¡é“ç¼“å†²åŒºå¤§å°ï¼š
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å‘½ä»¤ï¼šulimit -a
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å‡½æ•°ï¼šfpathconf å‚2ï¼š_PC_PIPE_BUF
<br> ğŸ˜Š ç®¡é“ä¼˜åŠ£ï¼š
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ä¼˜ç‚¹ï¼šå®ç°æ‰‹æ®µç®€å•
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ç¼ºç‚¹ï¼šå•å‘é€šä¿¡ã€åªèƒ½åœ¨æœ‰è¡€ç¼˜å…³ç³»è¿›ç¨‹é—´ä½¿ç”¨
<br>
<br><font color=black size = 5><a name="bc3">FIFOï¼šæ— è¡€ç¼˜å…³ç³»è¿›ç¨‹é—´é€šä¿¡</a></font>
<br>ä¹Ÿç§°å‘½ä»¤ç®¡é“(LinuxåŸºç¡€æ–‡ä»¶ç±»å‹)
<br>&nbsp;&nbsp;&nbsp;&nbsp; åˆ›å»ºï¼š
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å‘½ä»¤ï¼šmkfifo
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å‡½æ•°ï¼šmkfifo  å‚æ•°nameã€mode(å…«è¿›åˆ¶)    è¿”å›å€¼ï¼šæˆåŠŸè¿”å›0ã€å¤±è´¥è¿”å›-1ï¼Œè®¾ç½®error
<br>&nbsp;&nbsp;&nbsp;&nbsp; æ³¨æ„éœ€è¦ä½¿ç”¨åŒä¸€ä¸ªFIFOé€šä¿¡ï¼Œå¯è¿›è¡Œå¤šè¯»ç«¯ã€å¤šå†™ç«¯é€šä¿¡
<br>
<br><font color=black size = 5><a name="bc4">å…±äº«å­˜å‚¨æ˜ å°„</a></font>
<br>mmapå‡½æ•°ï¼šå‚æ•°å¤šï¼Œæ¯ä¸€ä¸ªå‚æ•°éƒ½æœ‰å¯èƒ½é€ æˆè°ƒç”¨å¤±è´¥
<br>&nbsp;&nbsp;&nbsp;&nbsp; è¿”å›å€¼ï¼›
<br>&nbsp;&nbsp;&nbsp;&nbsp; å€ŸåŠ©åˆ›å»ºçš„å…±äº«å†…å­˜è®¿é—®ç£ç›˜æ–‡ä»¶ (åˆ©ç”¨æŒ‡é’ˆ)
<br>&nbsp;&nbsp;&nbsp;&nbsp; çˆ¶å­è¿›ç¨‹ã€è¡€ç¼˜å…³ç³»è¿›ç¨‹ä¹‹é—´è¿›è¡Œé€šä¿¡
<br>&nbsp;&nbsp;&nbsp;&nbsp; åˆ©ç”¨mmapåˆ›å»ºåŒ¿åæ˜ å°„åŒº
<br>
<br><font color=black size = 5><a name="bc5">æ–‡ä»¶è¿›ç¨‹é—´é€šä¿¡</a></font>
<br> ğŸ˜Š ä½¿ç”¨æ–‡ä»¶ä¹Ÿå¯ä»¥å®ŒæˆIPCï¼Œç†è®ºä¾æ®æ˜¯forkåï¼Œçˆ¶å­è¿›ç¨‹å…±äº«æ–‡ä»¶æè¿°ç¬¦ï¼Œä¹Ÿå°±å…±äº«æ‰“å¼€çš„æ–‡ä»¶
<br>ç¼–ç¨‹å®æˆ˜ï¼šç¼–ç¨‹æµ‹è¯•ï¼Œçˆ¶å­è¿›ç¨‹å…±äº«æ‰“å¼€çš„æ–‡ä»¶ï¼Œå€ŸåŠ©æ–‡ä»¶è¿›è¡Œè¿›ç¨‹é—´é€šä¿¡
<br><div style="width:100%;border:1px #e3e3e3 solid;"><div style="width:100%;font-family:'Consolas', 'Courier New';font-size:12px;border-bottom:1px solid #e3e3e3;margin-top:5px;color:#000000;">&nbsp;C++ Code&nbsp;</div><table style="width:100%;font-family:'Consolas', 'Courier New';font-size:12px;vertical-align:text-top;line-height:15px;" border="0" cellspacing="0" cellpadding="0"><tr><td style="color:#008284;background-color:#e3e3e3;vertical-align:text-top;"><div style="margin:7px;text-align:right;white-space:nowrap;"><nobr>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br></nobr></div></td><td style="background-color:#008284;padding:1px;"><div style="border:1px #008284 solid;"></div></td><td style="background-color:#efefef;width:100%;vertical-align:text-top;color:#000000;"><div style="margin:7px;"><span style="color:#008000;">/*<BR>
&nbsp;*&nbsp;çˆ¶å­è¿›ç¨‹å…±äº«æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œä½¿ç”¨æ–‡ä»¶å®Œæˆè¿›ç¨‹é—´é€šä¿¡<BR>
&nbsp;*/</span><span style="color:#000000;"><BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;iostream&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;unistd.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;string.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;stdlib.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;fcntl.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;sys/wait.h&gt;<BR>
</span><span style="color:#0000ff;">using</span><span style="color:#000000;">&nbsp;</span><span style="color:#0000ff;">namespace</span><span style="color:#000000;">&nbsp;std;<BR>
<BR>
</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;main()<BR>
{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;fd1,&nbsp;fd2;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pid_t&nbsp;pid;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">char</span><span style="color:#000000;">&nbsp;buf[</span><span style="color:#ff0000;">1024</span><span style="color:#000000;">];<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">char</span><span style="color:#000000;">&nbsp;*str&nbsp;=&nbsp;</span><span style="color:#800000;">&quot;Test&nbsp;for&nbsp;shared&nbsp;fd&nbsp;in&nbsp;parent&nbsp;and&nbsp;child&nbsp;process...\n&quot;</span><span style="color:#000000;">;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pid&nbsp;=&nbsp;fork();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(pid&nbsp;&lt;&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;fork&nbsp;error!&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(</span><span style="color:#ff0000;">1</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">else</span><span style="color:#000000;">&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">(pid&nbsp;==&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fd1&nbsp;=&nbsp;open(</span><span style="color:#800000;">&quot;a.txt&quot;</span><span style="color:#000000;">,&nbsp;O_RDWR);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(fd1&nbsp;&lt;&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;child&nbsp;process&nbsp;open&nbsp;error!&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(</span><span style="color:#ff0000;">1</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">else</span><span style="color:#000000;"><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write(fd1,&nbsp;str,&nbsp;strlen(str));<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;child&nbsp;wrote&nbsp;over...&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">else</span><span style="color:#000000;"><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fd2&nbsp;=&nbsp;open(</span><span style="color:#800000;">&quot;a.txt&quot;</span><span style="color:#000000;">,&nbsp;O_RDWR);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(fd2&nbsp;&lt;&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;parent&nbsp;process&nbsp;open&nbsp;error!&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(</span><span style="color:#ff0000;">1</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleep(</span><span style="color:#ff0000;">1</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;len&nbsp;=&nbsp;read(fd2,&nbsp;buf,&nbsp;</span><span style="color:#0000ff;">sizeof</span><span style="color:#000000;">(buf));<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write(STDOUT_FILENO,&nbsp;buf,&nbsp;len);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wait(</span><span style="color:#0000ff;">NULL</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">return</span><span style="color:#000000;">&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">;<BR>
}</span></div></td></tr></table></div>
<br>æ€è€ƒï¼šæ— è¡€ç¼˜å…³ç³»çš„è¿›ç¨‹å¯ä»¥æ‰“å¼€åŒä¸€ä¸ªæ–‡ä»¶è¿›è¡Œé€šä¿¡å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ
<br>
<br><font color=black size = 5><a name="bc6">å­˜å‚¨æ˜ å°„ I/O</a></font>
<br>å­˜å‚¨æ˜ å°„I/O (Memory-mapped I/O)ä½¿ä¸€ä¸ªç£ç›˜æ–‡ä»¶ä¸å­˜å‚¨ç©ºé—´ä¸­çš„ä¸€ä¸ªç¼“å†²åŒºç›¸æ˜ å°„ï¼Œäºæ˜¯ä»ç¼“å†²åŒºä¸­å–æ•°æ®ï¼Œå°±ç›¸å½“äºè¯»æ–‡ä»¶ä¸­çš„ç›¸åº”å­—èŠ‚ï¼Œä¸æ­¤ç±»ä¼¼ï¼Œå°†æ•°æ®å­˜å…¥ç¼“å†²åŒºï¼Œåˆ™ç›¸åº”çš„å­—èŠ‚å°±è‡ªåŠ¨å†™å…¥æ–‡ä»¶ï¼Œè¿™æ ·ï¼Œå°±å¯ä»¥åœ¨ä¸ä½¿ç”¨readå’Œwriteå‡½æ•°çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨åœ°å€(æŒ‡é’ˆ)å®ŒæˆI/Oæ“ä½œ
<br>ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œé¦–å…ˆåº”è¯¥é€šçŸ¥å†…æ ¸ï¼Œå°†ä¸€ä¸ªæŒ‡å®šæ–‡ä»¶æ˜ å°„åˆ°å­˜å‚¨åŒºåŸŸä¸­ï¼Œè¿™ä¸ªæ˜ å°„å·¥ä½œå¯ä»¥é€šè¿‡mmapå‡½æ•°æ¥å®ç°
<br><img src="https://github.com/oubc/oubc.github.io/blob/master/images/L16_OScode1.png?raw=true" width="800" height="450" />
<br>
<br><font color=black size = 5><a name="bc7">mmap() å‡½æ•°</a></font>
<br> ğŸ˜Š void *mmap(void *addr, size_t length, int prot, int flags, int fd, off_t offset);
<br> ğŸ˜Š è¿”å›å€¼ï¼šæˆåŠŸè¿”å›åˆ›å»ºçš„æ˜ å°„åŒºé¦–åœ°å€ï¼Œå¤±è´¥è¿”å› MAP_FAILED å®
<br> ğŸ˜Š å‚æ•°ï¼š
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; addrï¼šå»ºç«‹æ˜ å°„åŒºçš„é¦–åœ°å€ï¼Œç”±Linuxå†…æ ¸æŒ‡å®šï¼Œä½¿ç”¨æ—¶ï¼Œç›´æ¥ä¼ é€’NULL
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lengthï¼šæ¬²åˆ›å»ºæ˜ å°„åŒºçš„å¤§å°
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protï¼šæ˜ å°„åŒºæƒé™ PROT_READã€PROT_WRITEã€PROT_READ|PROT_WRITE
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; flgsï¼šæ ‡å¿—ä½å‚æ•°(å¸¸ç”¨äºè®¾å®šæ›´æ–°ç‰©ç†åŒºåŸŸï¼Œè®¾ç½®å…±äº«ã€åˆ›å»ºåŒ¿åæ˜ å°„åŒº)
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MAP_SHAREDï¼šä¼šå°†æ˜ å°„åŒºæ‰€åšçš„æ“ä½œåæ˜ åˆ°ç‰©ç†è®¾å¤‡(ç£ç›˜)ä¸Š
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MAP_PRIVATEï¼šæ˜ å°„åŒºæ‰€åšçš„ä¿®æ”¹ä¸ä¼šåæ˜ åˆ°ç‰©ç†è®¾å¤‡
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fdï¼šç”¨æ¥å»ºç«‹æ˜ å°„åŒºçš„æ–‡ä»¶æè¿°ç¬¦
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; offsetï¼šæ˜ å°„æ–‡ä»¶çš„åç§»(4Kçš„æ•´æ•°å€)
<br> ğŸ˜Š ç¼–ç¨‹å®æˆ˜ï¼šåˆ©ç”¨mmapåˆ›å»ºæ˜ å°„åŒº
<br><div style="width:100%;border:1px #e3e3e3 solid;"><div style="width:100%;font-family:'Consolas', 'Courier New';font-size:12px;border-bottom:1px solid #e3e3e3;margin-top:5px;color:#000000;">&nbsp;C++ Code&nbsp;</div><table style="width:100%;font-family:'Consolas', 'Courier New';font-size:12px;vertical-align:text-top;line-height:15px;" border="0" cellspacing="0" cellpadding="0"><tr><td style="color:#008284;background-color:#e3e3e3;vertical-align:text-top;"><div style="margin:7px;text-align:right;white-space:nowrap;"><nobr>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br></nobr></div></td><td style="background-color:#008284;padding:1px;"><div style="border:1px #008284 solid;"></div></td><td style="background-color:#efefef;width:100%;vertical-align:text-top;color:#000000;"><div style="margin:7px;"><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;iostream&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;unistd.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;string.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;sys/types.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;sys/mman.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;fcntl.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;stdlib.h&gt;<BR>
</span><span style="color:#0000ff;">using</span><span style="color:#000000;">&nbsp;</span><span style="color:#0000ff;">namespace</span><span style="color:#000000;">&nbsp;std;<BR>
<BR>
</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;main()<BR>
{<BR>
&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">char</span><span style="color:#000000;">&nbsp;*p&nbsp;=&nbsp;</span><span style="color:#0000ff;">NULL</span><span style="color:#000000;">;<BR>
&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;fd&nbsp;=&nbsp;open(</span><span style="color:#800000;">&quot;b.txt&quot;</span><span style="color:#000000;">,&nbsp;O_CREAT|O_RDWR,&nbsp;</span><span style="color:#ff0000;">0644</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(fd&nbsp;&lt;&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">)<BR>
&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;open&nbsp;error!&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(</span><span style="color:#ff0000;">1</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;</span><span style="color:#008000;">//&nbsp;è·å–æ–‡ä»¶å¤§å°&nbsp;lseekã€ftruncateã€truncate<BR>
</span><span style="color:#000000;">&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;len&nbsp;=&nbsp;ftruncate(fd,&nbsp;</span><span style="color:#ff0000;">4</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(len&nbsp;==&nbsp;-</span><span style="color:#ff0000;">1</span><span style="color:#000000;">)<BR>
&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;ftruncate&nbsp;error!&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(</span><span style="color:#ff0000;">1</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;p&nbsp;=&nbsp;(</span><span style="color:#8000ff;">char</span><span style="color:#000000;">*)mmap(</span><span style="color:#0000ff;">NULL</span><span style="color:#000000;">,&nbsp;</span><span style="color:#ff0000;">4</span><span style="color:#000000;">,&nbsp;PROT_READ&nbsp;|&nbsp;PROT_WRITE,&nbsp;MAP_SHARED,&nbsp;fd,&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(p&nbsp;==&nbsp;MAP_FAILED)<BR>
&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;mmap&nbsp;error!&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(</span><span style="color:#ff0000;">1</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;strcpy(p,&nbsp;</span><span style="color:#800000;">&quot;abc&quot;</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;ret&nbsp;=&nbsp;munmap(p,&nbsp;</span><span style="color:#ff0000;">4</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(ret&nbsp;&lt;&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">)<BR>
&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;munmap&nbsp;error!&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(</span><span style="color:#ff0000;">1</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;close(fd);<BR>
&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">return</span><span style="color:#000000;">&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">;<BR>
}</span></div></td></tr></table></div>
<br> ğŸ˜Š æ€è€ƒé¢˜ï¼š
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0ã€å¯ä»¥opençš„æ—¶å€™O_CREATä¸€ä¸ªæ–°æ–‡ä»¶æ¥åˆ›å»ºæ˜ å°„åŒº
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å½“ç„¶å¯ä»¥ï¼Œä¸Šé¢ç¨‹åºå°±æ˜¯å®ä¾‹
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1ã€å¦‚æœpæŒ‡é’ˆåšäº†++æ“ä½œï¼Œmunmapæ˜¯å¦æˆåŠŸ
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ä¸ä¼šæˆåŠŸï¼Œå› ä¸ºmunmapæ“ä½œçš„æ˜¯é¦–åœ°å€
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2ã€å¦‚æœopenæ—¶O_RDONLYï¼Œmmapæ—¶PROTå‚æ•°æŒ‡å®šPROT_READ|PROT_WRITEä¼šæ€æ ·
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ä¸è¡Œï¼Œæƒé™ä¸è¶³ï¼Œåˆ›å»ºæ˜ å°„åŒºçš„æƒé™ &lt;= æ–‡ä»¶çš„æƒé™ï¼Œæ˜ å°„åŒºåˆ›å»ºçš„è¿‡ç¨‹å½“ä¸­éšå«å¯¹æ–‡ä»¶çš„ä¸€æ¬¡è¯»æ“ä½œï¼Œæ•…ä¸€å®šéœ€è¦è¯»æƒé™
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3ã€å¦‚æœæ–‡ä»¶åç§»é‡(æœ€åä¸€ä¸ªå‚æ•°)ä¸º1000ä¼šæ€ä¹ˆæ ·(æ–‡ä»¶è¶³å¤Ÿå¤§çš„æƒ…å†µä¸‹)
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ä¼šå‡ºé”™ï¼Œå¿…é¡»å¾—æ˜¯4Kå¾—æ•´æ•°å€ï¼ŒåŸå› æ˜¯MMUå¸®å¿™å®Œæˆæ˜ å°„çš„ï¼ŒMMUå³ä¸º4K
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4ã€å¦‚æœä¸æ£€æµ‹mmapçš„è¿”å›å€¼ï¼Œä¼šæ€æ ·
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ä¼šæ­»å¾—å¾ˆéš¾çœ‹
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5ã€mmapä»€ä¹ˆæƒ…å†µä¸‹ä¼šè°ƒç”¨å¤±è´¥
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å„ç§æƒ…å†µï¼Œç©ºé—´ä¸º0ã€æƒé™é—®é¢˜ï¼Œ
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6ã€å¯¹memè¶Šç•Œæ“ä½œä¼šæ€ä¹ˆæ ·
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ä¸èƒ½æ­£å¸¸munmap
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 7ã€æ–‡ä»¶æè¿°ç¬¦å…³é—­ï¼Œå¯¹mmapæ˜ å°„æœ‰æ²¡æœ‰å½±å“
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æ²¡æœ‰å½±å“ï¼Œæ˜ å°„åŒºä¸€æ—¦åˆ›å»ºæˆåŠŸï¼Œæ–‡ä»¶æè¿°ç¬¦ä¾¿æ²¡æœ‰äº†æ„ä¹‰
<br> ğŸ˜Š æ€»ç»“ï¼šmmapä½¿ç”¨çš„æ³¨æ„äº‹é¡¹ï¼š
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0ã€åˆ›å»ºæ˜ å°„åŒºçš„è¿‡ç¨‹ä¸­ï¼Œéšå«ç€ä¸€æ¬¡å¯¹æ˜ å°„æ–‡ä»¶çš„è¯»æ“ä½œ
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1ã€å½“MAP_SHAREDæ—¶ï¼Œè¦æ±‚ï¼šæ˜ å°„åŒºçš„æƒé™åº” &lt;= æ–‡ä»¶æ‰“å¼€çš„æƒé™(å‡ºäºå¯¹æ˜ å°„åŒºçš„ä¿æŠ¤)ï¼Œè€ŒMAP_PRIVATEåˆ™æ— æ‰€è°“ï¼Œå› ä¸ºmmapä¸­çš„æƒé™æ˜¯å¯¹å†…å­˜çš„é™åˆ¶
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2ã€æ˜ å°„åŒºçš„é‡Šæ”¾ä¸æ–‡ä»¶å…³é—­æ— å…³ï¼Œåªè¦æ˜ å°„åŒºå»ºç«‹æˆåŠŸï¼Œæ–‡ä»¶å¯ä»¥ç«‹å³å…³é—­
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3ã€ç‰¹åˆ«æ³¨æ„ï¼Œå½“æ˜ å°„åŒºæ–‡ä»¶å¤§å°ä¸º0æ—¶ï¼Œä¸èƒ½åˆ›å»ºæ˜ å°„åŒºï¼Œæ‰€ä»¥ï¼Œç”¨äºæ˜ å°„çš„æ–‡ä»¶å¿…é¡»è¦æœ‰å®é™…çš„å¤§å°ï¼Œmmapæ—¶å¸¸å‡ºç°æ€»çº¿é”™è¯¯ï¼Œé€šå¸¸æ˜¯ç”±äºå…±äº«æ–‡ä»¶å­˜å‚¨ç©ºé—´å¤§å°å¼•èµ·çš„
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4ã€munmapä¼ å…¥çš„åœ°å€ä¸€å®šæ˜¯mmapçš„è¿”å›åœ°å€ï¼Œåšå†³æœç»æŒ‡é’ˆ++ã€--æ“ä½œ
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5ã€æ–‡ä»¶åç§»é‡å¿…é¡»æ˜¯4Kçš„æ•´æ•°å€
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6ã€mmapåˆ›å»ºæ˜ å°„åŒºå‡ºé”™æ¦‚ç‡éå¸¸é«˜ï¼Œä¸€å®šè¦æ£€æŸ¥è¿”å›å€¼ï¼Œç¡®ä¿æ˜ å°„åŒºå»ºç«‹æˆåŠŸå†è¿›è¡Œåç»­æ“ä½œ
<br>
<br><font color=black size = 5><a name="bc8">mmap çˆ¶å­è¿›ç¨‹é—´é€šä¿¡</a></font>
<br>çˆ¶å­ç­‰æœ‰è¡€ç¼˜å…³ç³»çš„è¿›ç¨‹ä¹‹é—´å¯ä»¥é€šè¿‡mmapå»ºç«‹çš„æ˜ å°„åŒºæ¥å®Œæˆæ•°æ®é€šä¿¡ï¼Œä½†ç›¸åº”çš„è¦åœ¨åˆ›å»ºæ˜ å°„åŒºçš„æ—¶å€™æŒ‡å®šå¯¹åº”å¾—æ ‡å¿—ä½flags
<br>&nbsp;&nbsp;&nbsp;&nbsp; MAP_PRIVATEï¼šç§æœ‰æ˜ å°„ï¼Œçˆ¶å­è¿›ç¨‹ç‹¬å æ˜ å°„åŒº
<br>&nbsp;&nbsp;&nbsp;&nbsp; MAP_SHAREDï¼šå…±äº«æ˜ å°„ï¼Œçˆ¶å­è¿›ç¨‹å…±äº«æ˜ å°„åŒº
<br> ğŸ˜Š ç¼–ç¨‹å®æˆ˜ï¼Œmmapåœ¨çˆ¶å­è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡
<br><div style="width:100%;border:1px #e3e3e3 solid;"><div style="width:100%;font-family:'Consolas', 'Courier New';font-size:12px;border-bottom:1px solid #e3e3e3;margin-top:5px;color:#000000;">&nbsp;C++ Code&nbsp;</div><table style="width:100%;font-family:'Consolas', 'Courier New';font-size:12px;vertical-align:text-top;line-height:15px;" border="0" cellspacing="0" cellpadding="0"><tr><td style="color:#008284;background-color:#e3e3e3;vertical-align:text-top;"><div style="margin:7px;text-align:right;white-space:nowrap;"><nobr>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br></nobr></div></td><td style="background-color:#008284;padding:1px;"><div style="border:1px #008284 solid;"></div></td><td style="background-color:#efefef;width:100%;vertical-align:text-top;color:#000000;"><div style="margin:7px;"><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;iostream&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;stdlib.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;fcntl.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;unistd.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;sys/mman.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;sys/wait.h&gt;<BR>
</span><span style="color:#0000ff;">using</span><span style="color:#000000;">&nbsp;</span><span style="color:#0000ff;">namespace</span><span style="color:#000000;">&nbsp;std;<BR>
<BR>
</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;var&nbsp;=&nbsp;</span><span style="color:#ff0000;">100</span><span style="color:#000000;">;<BR>
</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;main()<BR>
{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;*p;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pid_t&nbsp;pid;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;fd;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fd&nbsp;=&nbsp;open(</span><span style="color:#800000;">&quot;c.txt&quot;</span><span style="color:#000000;">,&nbsp;O_CREAT|O_RDWR|O_TRUNC,&nbsp;</span><span style="color:#ff0000;">0644</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">(fd&nbsp;&lt;&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;open&nbsp;error!&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(</span><span style="color:#ff0000;">1</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unlink(</span><span style="color:#800000;">&quot;c.txt&quot;</span><span style="color:#000000;">);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#008000;">//&nbsp;åˆ é™¤ä¸´æ—¶æ–‡ä»¶ç›®å½•é¡¹ï¼Œä½¿ä¹‹å…·å¤‡è¢«é‡Šæ”¾æ¡ä»¶<BR>
</span><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#008000;">//&nbsp;æ‰€æœ‰ä½¿ç”¨è¯¥æ–‡ä»¶çš„è¿›ç¨‹éƒ½è¢«é‡Šæ”¾åè¯¥æ–‡ä»¶å°±ä¼šè¢«åˆ é™¤<BR>
</span><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ftruncate(fd,&nbsp;</span><span style="color:#ff0000;">4</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;=&nbsp;(</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;*)mmap(</span><span style="color:#0000ff;">NULL</span><span style="color:#000000;">,&nbsp;</span><span style="color:#ff0000;">4</span><span style="color:#000000;">,&nbsp;PROT_READ|PROT_WRITE,&nbsp;MAP_SHARED,&nbsp;fd,&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">(p&nbsp;==&nbsp;MAP_FAILED)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;mmap&nbsp;error!&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(</span><span style="color:#ff0000;">1</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close(fd);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#008000;">//&nbsp;æ˜ å°„åŒºå»ºç«‹å®Œæ¯•ï¼Œå³å¯å…³é—­æ–‡ä»¶<BR>
</span><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pid&nbsp;=&nbsp;fork();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(pid&nbsp;==&nbsp;-</span><span style="color:#ff0000;">1</span><span style="color:#000000;">)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;fork&nbsp;error!&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(</span><span style="color:#ff0000;">1</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">else</span><span style="color:#000000;">&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(pid&nbsp;==&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*p&nbsp;=&nbsp;</span><span style="color:#ff0000;">2000</span><span style="color:#000000;">;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;=&nbsp;</span><span style="color:#ff0000;">1000</span><span style="color:#000000;">;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;child&nbsp;process,&nbsp;*p&nbsp;=&nbsp;&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;*p&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;,&nbsp;var&nbsp;=&nbsp;&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;var&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">else</span><span style="color:#000000;"><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleep(</span><span style="color:#ff0000;">1</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;parent&nbsp;process,&nbsp;*p&nbsp;=&nbsp;&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;*p&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;,&nbsp;var&nbsp;=&nbsp;&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;var&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wait(</span><span style="color:#0000ff;">NULL</span><span style="color:#000000;">);<BR>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;ret&nbsp;=&nbsp;munmap(p,&nbsp;</span><span style="color:#ff0000;">4</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(ret&nbsp;==&nbsp;-</span><span style="color:#ff0000;">1</span><span style="color:#000000;">)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;munmap&nbsp;error!&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(</span><span style="color:#ff0000;">1</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">return</span><span style="color:#000000;">&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">;<BR>
}</span></div></td></tr></table></div>
<br>&nbsp;&nbsp;&nbsp;&nbsp; ç»“æœï¼šchild process, *p = 2000, var = 1000
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent process, *p = 2000, var = 100
<br>&nbsp;&nbsp;&nbsp;&nbsp; ç»“è®ºï¼šçˆ¶å­è¿›ç¨‹å…±äº«æ‰“å¼€çš„æ–‡ä»¶ã€mmapå»ºç«‹çš„æ˜ å°„åŒº(ä½†å¿…é¡»è¦ä½¿ç”¨MAP_SHARED)
<br>
<br><font color=black size = 5><a name="bc9">åŒ¿åæ˜ å°„åŒº</a></font>
<br>é€šè¿‡ä½¿ç”¨mmapæˆ‘ä»¬å‘ç°ï¼Œä½¿ç”¨æ˜ å°„åŒºæ¥å®Œæˆæ–‡ä»¶è¯»å†™æ“ä½œååˆ†æ–¹ä¾¿ï¼Œçˆ¶å­è¿›ç¨‹é—´é€šä¿¡ä¹Ÿè¾ƒå®¹æ˜“ï¼Œä½†ç¼ºé™·æ˜¯ï¼Œæ¯æ¬¡åˆ›å»ºæ˜ å°„åŒºä¸€å®šè¦ä¾èµ–ä¸€ä¸ªæ–‡ä»¶æ‰èƒ½å®ç°ï¼Œé€šå¸¸ä¸ºäº†å»ºç«‹æ˜ å°„åŒºè¦openä¸€ä¸ªæ–‡ä»¶ï¼Œåˆ›å»ºå¥½äº†å†ulinkã€closeæ–‡ä»¶ï¼Œæ¯”è¾ƒéº»çƒ¦ã€‚
<br>å¯ä»¥ç›´æ¥ä½¿ç”¨åŒ¿åæ˜ å°„æ¥ä»£æ›¿ï¼Œå…¶å®Linuxç³»ç»Ÿç»™æˆ‘ä»¬æä¾›äº†åˆ›å»ºåŒ¿åæ˜ å°„åŒºå¾—æ–¹æ³•ï¼Œæ— éœ€ä¾èµ–ä¸€ä¸ªæ–‡ä»¶å³å¯åˆ›å»ºæ˜ å°„åŒºï¼ŒåŒæ ·éœ€è¦å€ŸåŠ©æ ‡å¿—ä½å‚æ•°flagsæ¥æŒ‡å®šã€‚
<br>ä½¿ç”¨ MAP_ANONYMOUS (æˆ– MAP_ANON)ï¼Œå¦‚ï¼š
<br>&nbsp;&nbsp;&nbsp;&nbsp; int *p = (int *)mmap(NULL, 4, PROT_READ|PROT_WIRTE, MAP_SHARED|MAP_ANONYMOUS, -1, 0);
<br>&quot;4&quot; éšæ„ä¸¾ä¾‹ï¼Œè¯¥ä½ç½®è¡¨å¤§å°ï¼Œå¯ä¾å®é™…å¤§å°å¡«å†™
<br>æ³¨æ„ï¼šMAP_ANONYMOUSå’ŒMAP_ANONè¿™ä¸¤ä¸ªå®æ˜¯Linuxæ“ä½œç³»ç»Ÿç‰¹æœ‰å¾—å®ï¼Œåœ¨ç±»Unixç³»ç»Ÿä¸­å¦‚æ— è¯¥å®å®šä¹‰ï¼Œå¯ä½¿ç”¨å¦‚ä¸‹æ­¥éª¤å®ŒæˆåŒ¿åæ˜ å°„åŒºçš„å»ºç«‹
<br>&nbsp;&nbsp;&nbsp;&nbsp; fd = open(&quot;/dev/zero&quot;, O_RDWR);
<br>&nbsp;&nbsp;&nbsp;&nbsp; p = mmap(NULL, size, PROT_READ|PROT_WRITE, MAP_SHARED, fd, 0);
<br>æ‰©å±•çŸ¥è¯†ï¼š/dev/zero  æ²¡å¤§å°ï¼Œä½†è¿™ä¸ªæ–‡ä»¶å¾ˆç¥å¥‡ï¼Œæƒ³è¦å¤šå¤§ï¼Œå®ƒå°±èƒ½æä¾›å¤šå¤§   åï¼šæºæºä¸æ–­
<br>&nbsp;&nbsp;&nbsp;&nbsp; /dev/null      æ— åº•æ´ï¼Œæ²¡å¤§å°ï¼Œä½ å¾€é‡Œé¢å†™ä¸œè¥¿ï¼Œå®ƒå°±èƒ½æ¥å—å¤šå°‘ä¸œè¥¿   åƒï¼šæ°¸è¿œåƒä¸å®Œ
<br>&nbsp;&nbsp;&nbsp;&nbsp; å­—ç¬¦è®¾å¤‡æ–‡ä»¶ (ä¼ªæ–‡ä»¶)
<br>
<br><font color=black size = 5><a name="bc10">mmapæ— è¡€ç¼˜å…³ç³»è¿›ç¨‹é—´é€šä¿¡</a></font>
<br>å®è´¨ä¸Šmmapæ˜¯å†…æ ¸å€ŸåŠ©æ–‡ä»¶å¸®åŠ©æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ˜ å°„åŒºï¼Œå¤šä¸ªè¿›ç¨‹ä¹‹é—´åˆ©ç”¨è¯¥æ˜ å°„åŒºå®Œæˆæ•°æ®ä¼ é€’ï¼Œç”±äºå†…æ ¸ç©ºé—´å¤šè¿›ç¨‹å…±äº«ï¼Œå› æ­¤æ— è¡€ç¼˜å…³ç³»çš„è¿›ç¨‹é—´ä¹Ÿå¯ä»¥ä½¿ç”¨mmapæ¥å®Œæˆé€šä¿¡ï¼Œåªè¦è®¾ç½®ç›¸åº”çš„æ ‡å¿—ä½å‚æ•°flagså³å¯ã€‚
<br>&nbsp;&nbsp;&nbsp;&nbsp; è‹¥æƒ³å®ç°å…±äº«ï¼Œå½“ç„¶åº”è¯¥ä½¿ç”¨MAP_SHARED
<br>&nbsp;&nbsp;&nbsp;&nbsp; (æ–¹æ³•) æ˜ å°„åŒºå¯ä»¥å½“åšæ•°ç»„çœ‹å¾…
ç¼–ç¨‹å®æˆ˜ï¼šmmapæ— è¡€ç¼˜å…³ç³»è¿›ç¨‹é—´é€šä¿¡
<br> ğŸ˜Š mmap_w.cpp
<br><div style="width:100%;border:1px #e3e3e3 solid;"><div style="width:100%;font-family:'Consolas', 'Courier New';font-size:12px;border-bottom:1px solid #e3e3e3;margin-top:5px;color:#000000;">&nbsp;C++ Code&nbsp;</div><table style="width:100%;font-family:'Consolas', 'Courier New';font-size:12px;vertical-align:text-top;line-height:15px;" border="0" cellspacing="0" cellpadding="0"><tr><td style="color:#008284;background-color:#e3e3e3;vertical-align:text-top;"><div style="margin:7px;text-align:right;white-space:nowrap;"><nobr>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br></nobr></div></td><td style="background-color:#008284;padding:1px;"><div style="border:1px #008284 solid;"></div></td><td style="background-color:#efefef;width:100%;vertical-align:text-top;color:#000000;"><div style="margin:7px;"><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;iostream&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;unistd.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;fcntl.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;sys/mman.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;sys/stat.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;stdlib.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;string.h&gt;<BR>
</span><span style="color:#0000ff;">using</span><span style="color:#000000;">&nbsp;</span><span style="color:#0000ff;">namespace</span><span style="color:#000000;">&nbsp;std;<BR>
</span><span style="color:#0000ff;">struct</span><span style="color:#000000;">&nbsp;STU<BR>
{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;id;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">char</span><span style="color:#000000;">&nbsp;name[</span><span style="color:#ff0000;">10</span><span style="color:#000000;">];<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">char</span><span style="color:#000000;">&nbsp;sex;<BR>
};<BR>
</span><span style="color:#8000ff;">void</span><span style="color:#000000;">&nbsp;sys_err(</span><span style="color:#8000ff;">char</span><span style="color:#000000;">&nbsp;*str)<BR>
{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;*str&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;error!&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(-</span><span style="color:#ff0000;">1</span><span style="color:#000000;">);<BR>
}<BR>
<BR>
</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;main(</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;argc,&nbsp;</span><span style="color:#8000ff;">char</span><span style="color:#000000;">*&nbsp;argv[])<BR>
{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;fd;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">struct</span><span style="color:#000000;">&nbsp;STU&nbsp;student&nbsp;=&nbsp;{</span><span style="color:#ff0000;">10</span><span style="color:#000000;">,&nbsp;</span><span style="color:#800000;">&quot;oubc&quot;</span><span style="color:#000000;">,&nbsp;</span><span style="color:#800000;">'m'</span><span style="color:#000000;">};<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">char</span><span style="color:#000000;">&nbsp;*mm;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(argc&nbsp;&lt;&nbsp;</span><span style="color:#ff0000;">2</span><span style="color:#000000;">)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;./a.out&nbsp;file_shared\n&quot;</span><span style="color:#000000;">;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(-</span><span style="color:#ff0000;">1</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fd&nbsp;=&nbsp;open(argv[</span><span style="color:#ff0000;">1</span><span style="color:#000000;">],&nbsp;O_RDWR|O_CREAT,&nbsp;</span><span style="color:#ff0000;">0644</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ftruncate(fd,&nbsp;</span><span style="color:#0000ff;">sizeof</span><span style="color:#000000;">(student));<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mm&nbsp;=&nbsp;(</span><span style="color:#0000ff;">struct</span><span style="color:#000000;">&nbsp;STU&nbsp;*)mmap(</span><span style="color:#0000ff;">NULL</span><span style="color:#000000;">,&nbsp;</span><span style="color:#0000ff;">sizeof</span><span style="color:#000000;">(student),&nbsp;PROT_READ|PROT_WRITE,&nbsp;MAP_SHARED,&nbsp;fd,&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(mm&nbsp;==&nbsp;MAP_FAILED)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys_err(</span><span style="color:#800000;">&quot;mmap&nbsp;&quot;</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close(fd);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">while</span><span style="color:#000000;">(</span><span style="color:#ff0000;">1</span><span style="color:#000000;">)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy(mm,&nbsp;&amp;student,&nbsp;</span><span style="color:#0000ff;">sizeof</span><span style="color:#000000;">(student));<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;student.id++;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleep(</span><span style="color:#ff0000;">1</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;munmap(mm,&nbsp;</span><span style="color:#0000ff;">sizeof</span><span style="color:#000000;">(student));<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">return</span><span style="color:#000000;">&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">;<BR>
}</span></div></td></tr></table></div>
<br> ğŸ˜Š mmap_r.cpp
<br><div style="width:100%;border:1px #e3e3e3 solid;"><div style="width:100%;font-family:'Consolas', 'Courier New';font-size:12px;border-bottom:1px solid #e3e3e3;margin-top:5px;color:#000000;">&nbsp;C++ Code&nbsp;</div><table style="width:100%;font-family:'Consolas', 'Courier New';font-size:12px;vertical-align:text-top;line-height:15px;" border="0" cellspacing="0" cellpadding="0"><tr><td style="color:#008284;background-color:#e3e3e3;vertical-align:text-top;"><div style="margin:7px;text-align:right;white-space:nowrap;"><nobr>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br></nobr></div></td><td style="background-color:#008284;padding:1px;"><div style="border:1px #008284 solid;"></div></td><td style="background-color:#efefef;width:100%;vertical-align:text-top;color:#000000;"><div style="margin:7px;"><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;iostream&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;unistd.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;fcntl.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;sys/mman.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;sys/stat.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;stdlib.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;string.h&gt;<BR>
</span><span style="color:#0000ff;">using</span><span style="color:#000000;">&nbsp;</span><span style="color:#0000ff;">namespace</span><span style="color:#000000;">&nbsp;std;<BR>
</span><span style="color:#0000ff;">struct</span><span style="color:#000000;">&nbsp;STU<BR>
{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;id;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">char</span><span style="color:#000000;">&nbsp;name[</span><span style="color:#ff0000;">10</span><span style="color:#000000;">];<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">char</span><span style="color:#000000;">&nbsp;sex;<BR>
};<BR>
</span><span style="color:#8000ff;">void</span><span style="color:#000000;">&nbsp;sys_err(</span><span style="color:#8000ff;">char</span><span style="color:#000000;">&nbsp;*str)<BR>
{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;*str&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;error!&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(-</span><span style="color:#ff0000;">1</span><span style="color:#000000;">);<BR>
}<BR>
<BR>
</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;main(</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;argc,&nbsp;</span><span style="color:#8000ff;">char</span><span style="color:#000000;">*&nbsp;argv[])<BR>
{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;fd;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">struct</span><span style="color:#000000;">&nbsp;STU&nbsp;student;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">struct</span><span style="color:#000000;">&nbsp;STU&nbsp;*mm;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(argc&nbsp;&lt;&nbsp;</span><span style="color:#ff0000;">2</span><span style="color:#000000;">)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;./a.out&nbsp;file_shared\n&quot;</span><span style="color:#000000;">;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(-</span><span style="color:#ff0000;">1</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fd&nbsp;=&nbsp;open(argv[</span><span style="color:#ff0000;">1</span><span style="color:#000000;">],&nbsp;O_RDONLY);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(fd&nbsp;==&nbsp;-</span><span style="color:#ff0000;">1</span><span style="color:#000000;">)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys_err(</span><span style="color:#800000;">&quot;open&nbsp;&quot;</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mm&nbsp;=&nbsp;(</span><span style="color:#0000ff;">struct</span><span style="color:#000000;">&nbsp;STU&nbsp;*)mmap(</span><span style="color:#0000ff;">NULL</span><span style="color:#000000;">,&nbsp;</span><span style="color:#0000ff;">sizeof</span><span style="color:#000000;">(</span><span style="color:#0000ff;">struct</span><span style="color:#000000;">&nbsp;STU),&nbsp;PROT_READ,&nbsp;MAP_SHARED,&nbsp;fd,&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(mm&nbsp;==&nbsp;MAP_FAILED)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys_err(</span><span style="color:#800000;">&quot;mmap&nbsp;&quot;</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close(fd);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">while</span><span style="color:#000000;">(</span><span style="color:#ff0000;">1</span><span style="color:#000000;">)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;id&nbsp;=&nbsp;&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;mm&nbsp;-&gt;&nbsp;id&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;&nbsp;name&nbsp;=&nbsp;&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;mm&nbsp;-&gt;&nbsp;name&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;&nbsp;sex&nbsp;=&nbsp;&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;mm&nbsp;-&gt;&nbsp;sex&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleep(</span><span style="color:#ff0000;">2</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;munmap(mm,&nbsp;</span><span style="color:#0000ff;">sizeof</span><span style="color:#000000;">(student));<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">return</span><span style="color:#000000;">&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">;<BR>
}</span></div></td></tr></table></div>
<br>
<br><font color=black size = 5><a name="bc11">å®ç°æ–‡ä»¶å¤šè¿›ç¨‹æ‹·è´</a></font>
<br>ç¼–ç¨‹å®æˆ˜ï¼šå®ç°æ–‡ä»¶å¤šè¿›ç¨‹æ‹·è´
<br> ğŸ˜Š å°†å…±äº«å†…å­˜åŒºåŸŸåˆ’åˆ†ä¸ºå¤šä¸ªéƒ¨åˆ†ï¼Œä½¿ç”¨å¤šè¿›ç¨‹å®ç°æ‹·è´
<br><div style="width:100%;border:1px #e3e3e3 solid;"><div style="width:100%;font-family:'Consolas', 'Courier New';font-size:12px;border-bottom:1px solid #e3e3e3;margin-top:5px;color:#000000;">&nbsp;C++ Code&nbsp;</div><table style="width:100%;font-family:'Consolas', 'Courier New';font-size:12px;vertical-align:text-top;line-height:15px;" border="0" cellspacing="0" cellpadding="0"><tr><td style="color:#008284;background-color:#e3e3e3;vertical-align:text-top;"><div style="margin:7px;text-align:right;white-space:nowrap;"><nobr>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>61<br>62<br>63<br>64<br>65<br>66<br>67<br></nobr></div></td><td style="background-color:#008284;padding:1px;"><div style="border:1px #008284 solid;"></div></td><td style="background-color:#efefef;width:100%;vertical-align:text-top;color:#000000;"><div style="margin:7px;"><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;iostream&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;fcntl.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;stdlib.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;unistd.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;sys/mman.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;sys/types.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;sys/wait.h&gt;<BR>
</span><span style="color:#0000ff;">#include</span><span style="color:#000000;">&nbsp;&lt;sys/stat.h&gt;<BR>
</span><span style="color:#0000ff;">using</span><span style="color:#000000;">&nbsp;</span><span style="color:#0000ff;">namespace</span><span style="color:#000000;">&nbsp;std;<BR>
<BR>
</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;main()<BR>
{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">int</span><span style="color:#000000;">&nbsp;fd1,&nbsp;fd2,&nbsp;i,&nbsp;m&nbsp;=&nbsp;</span><span style="color:#ff0000;">7</span><span style="color:#000000;">;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">char</span><span style="color:#000000;">*&nbsp;p&nbsp;=&nbsp;</span><span style="color:#0000ff;">NULL</span><span style="color:#000000;">;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#8000ff;">char</span><span style="color:#000000;">&nbsp;buf[</span><span style="color:#ff0000;">100</span><span style="color:#000000;">];<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pid_t&nbsp;pid,&nbsp;wpid;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fd1&nbsp;=&nbsp;open(</span><span style="color:#800000;">&quot;demo&quot;</span><span style="color:#000000;">,&nbsp;O_RDWR);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(fd1&nbsp;&lt;&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;open&nbsp;fd1&nbsp;error!&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(</span><span style="color:#ff0000;">1</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fd2&nbsp;=&nbsp;open(</span><span style="color:#800000;">&quot;demo_2&quot;</span><span style="color:#000000;">,&nbsp;O_CREAT|O_RDWR|O_TRUNC,&nbsp;</span><span style="color:#ff0000;">0644</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(fd2&nbsp;==&nbsp;-</span><span style="color:#ff0000;">1</span><span style="color:#000000;">)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;open&nbsp;fd2&nbsp;error!&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(</span><span style="color:#ff0000;">1</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;=&nbsp;(</span><span style="color:#8000ff;">char</span><span style="color:#000000;">&nbsp;*)mmap(</span><span style="color:#0000ff;">NULL</span><span style="color:#000000;">,&nbsp;</span><span style="color:#ff0000;">680</span><span style="color:#000000;">,&nbsp;PROT_READ|PROT_WRITE,&nbsp;MAP_SHARED,&nbsp;fd1,&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(p&nbsp;==&nbsp;MAP_FAILED)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;mmap&nbsp;error!&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(</span><span style="color:#ff0000;">1</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close(fd1);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">for</span><span style="color:#000000;">&nbsp;(i&nbsp;=&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">;&nbsp;i&nbsp;&lt;&nbsp;</span><span style="color:#ff0000;">7</span><span style="color:#000000;">;&nbsp;++i)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pid&nbsp;=&nbsp;fork();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(pid&nbsp;==&nbsp;-</span><span style="color:#ff0000;">1</span><span style="color:#000000;">)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;build&nbsp;the&nbsp;&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;i&nbsp;+&nbsp;</span><span style="color:#ff0000;">1</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;th&nbsp;process&nbsp;error!&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">else</span><span style="color:#000000;">&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">(pid&nbsp;==&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">break</span><span style="color:#000000;">;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(i&nbsp;&lt;&nbsp;</span><span style="color:#ff0000;">7</span><span style="color:#000000;">)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write(fd2,&nbsp;p&nbsp;+&nbsp;i*</span><span style="color:#ff0000;">100</span><span style="color:#000000;">,&nbsp;</span><span style="color:#ff0000;">100</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">else</span><span style="color:#000000;"><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;munmap(p,&nbsp;</span><span style="color:#ff0000;">680</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close(fd2);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">do</span><span style="color:#000000;"><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wpid&nbsp;=&nbsp;waitpid(-</span><span style="color:#ff0000;">1</span><span style="color:#000000;">,&nbsp;</span><span style="color:#0000ff;">NULL</span><span style="color:#000000;">,&nbsp;WNOHANG);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">&nbsp;(pid&nbsp;&gt;&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m--;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span style="color:#0000ff;">while</span><span style="color:#000000;">(m&nbsp;&gt;&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;</span><span style="color:#800000;">&quot;wait&nbsp;finish!&quot;</span><span style="color:#000000;">&nbsp;&lt;&lt;&nbsp;endl;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">return</span><span style="color:#000000;">&nbsp;</span><span style="color:#ff0000;">0</span><span style="color:#000000;">;<BR>
}</span></div></td></tr></table></div></p>

<p><br><br><br>
<font color = gray size = 3>å¦‚æœ‰é”™è¯¯ï¼Œæ¬¢è¿æŒ‡æ­£ï¼</font></p></div>
        <div class="post_footer">
          
          <div class="meta">
            <div class="info">
              <span class="field tags">
                <i class="remixicon-stack-line"></i>
                
                <a href="https://oubc.github.io/tags/linux/">Linux</a>
                
              </span>
            </div>
          </div>
          
        </div>
      </div>
      
      
    </div>
  </div>
  <a id="back_to_top" href="#" class="back_to_top"><span>â–³</span></a>
</div>
<footer class="footer">
  <div class="powered_by">
    <a href="https://wxt.sinaimg.cn/thumb300/007Diza3ly1g4l9lmg4aog3074074gnf.gif?tags=%5B%5D">I </a>
	<a href="">love</a>
    <a href="https://wxt.sinaimg.cn/thumb300/007Diza3ly1g4l9lmfm2eg306o06o74u.gif?tags=%5B%5D"> you </a>
    <a href="https://wxt.sinaimg.cn/thumb300/007Diza3ly1g4njrx4tpcj30fn0bq3zg.jpg?tags=%5B%5D">three </a>
	<a href="https://wxt.sinaimg.cn/thumb300/007Diza3ly1g4njrx64ctg307s07swfy.gif?tags=%5B%5D">thousand</a>
    <a href="https://www.kugou.com/song/#hash=96426C78381DE98DC31A5846FC274CBF&album_id=646623"> times.</a>
  </div>

  <div class="footer_slogan">
    <span>å®¶åº­ã€æ¢¦æƒ³ã€å†…å¿ƒçš„å¹³é™</span>
  </div>
</footer>



<script src="https://oubc.github.io/js/jquery-3.3.1.min.js"></script>
<script src="https://oubc.github.io/js/zozo.js"></script>
<script src="https://oubc.github.io/js/highlight.pack.js"></script>
<link  href="https://oubc.github.io/css/fancybox.min.css" rel="stylesheet">
<script src="https://oubc.github.io/js/fancybox.min.js"></script>

<script>hljs.initHighlightingOnLoad()</script>


  <script type="text/javascript" async src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[\[','\]\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});

MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<style>
code.has-jax {
    font: inherit;
    font-size: 100%;
    background: inherit;
    border: inherit;
    color: #515151;
}
</style>






</body>
</html>
